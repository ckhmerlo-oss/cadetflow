{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 18, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/ckhme/my-workflow-app/app/profile/%5Bid%5D/page.tsx"],"sourcesContent":["import { createClient } from '@/utils/supabase/server'\r\nimport Link from 'next/link'\r\nimport { notFound, redirect } from 'next/navigation'\r\n\r\n// Helper to determine current sport season\r\nfunction getCurrentSport(profile: any) {\r\n  const month = new Date().getMonth() // 0-11 (Jan-Dec)\r\n  \r\n  // Logic: \r\n  // Fall: Aug (7) - Nov (10)\r\n  // Winter: Dec (11) - Mar (2)\r\n  // Spring: Apr (3) - July (6)\r\n  \r\n  if (month >= 7 && month <= 10) {\r\n    return { season: 'Fall Sport', sport: profile.sport_fall || 'None' }\r\n  } else if (month === 11 || month <= 2) {\r\n    return { season: 'Winter Sport', sport: profile.sport_winter || 'None' }\r\n  } else {\r\n    return { season: 'Spring Sport', sport: profile.sport_spring || 'None' }\r\n  }\r\n}\r\n\r\nexport default async function ProfilePage({ params }: { params: Promise<{ id: string }> }) {\r\n  const { id } = await params\r\n  const supabase = createClient()\r\n\r\n  // 1. Auth Check\r\n  const { data: { user } } = await supabase.auth.getUser()\r\n  if (!user) return redirect('/login')\r\n\r\n  // 2. Fetch Profile Data\r\n  const { data: profile, error } = await supabase\r\n    .from('profiles')\r\n    .select(`\r\n      *,\r\n      company:company_id (company_name),\r\n      role:role_id (role_name)\r\n    `)\r\n    .eq('id', id)\r\n    .single()\r\n\r\n  if (error || !profile) {\r\n    console.error('Error fetching profile:', error)\r\n    return notFound()\r\n  }\r\n\r\n  // 3. Calculate Display Values\r\n  const currentSportData = getCurrentSport(profile)\r\n  const fullName = `${profile.last_name}, ${profile.first_name}`\r\n  \r\n  // Status Color Logic\r\n  const isProbation = !!profile.probation_status\r\n  const isGoodConduct = profile.conduct_status?.toLowerCase().includes('good') || !profile.conduct_status\r\n\r\n  return (\r\n    <div className=\"max-w-5xl mx-auto p-4 sm:p-6 lg:p-8\">\r\n      \r\n      {/* Header Section */}\r\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden mb-6\">\r\n        <div className=\"h-32 bg-indigo-600 dark:bg-indigo-900\"></div>\r\n        <div className=\"px-6 pb-6\">\r\n          <div className=\"relative flex justify-between items-end -mt-12 mb-4\">\r\n            <div className=\"flex items-end\">\r\n              <div className=\"h-24 w-24 rounded-full bg-white dark:bg-gray-800 p-1 shadow-lg\">\r\n                <div className=\"h-full w-full rounded-full bg-gray-200 dark:bg-gray-700 flex items-center justify-center text-2xl font-bold text-gray-500 dark:text-gray-400\">\r\n                  {profile.first_name[0]}{profile.last_name[0]}\r\n                </div>\r\n              </div>\r\n              <div className=\"ml-4 mb-1\">\r\n                <h1 className=\"text-3xl font-bold text-gray-900 dark:text-white\">{fullName}</h1>\r\n                <p className=\"text-gray-500 dark:text-gray-400 font-medium\">\r\n                  {profile.cadet_rank || 'Cadet'} &bull; {profile.role?.role_name || 'Unassigned'}\r\n                </p>\r\n              </div>\r\n            </div>\r\n            \r\n            <Link \r\n              href={`/ledger/${id}`}\r\n              className=\"py-2 px-4 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-200 font-medium rounded-md shadow-sm hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors\"\r\n            >\r\n              View Disciplinary Ledger\r\n            </Link>\r\n          </div>\r\n\r\n          {/* Key Stats Grid */}\r\n          <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 border-t border-gray-100 dark:border-gray-700 pt-6\">\r\n            <div className=\"p-3 bg-gray-50 dark:bg-gray-700/50 rounded-md\">\r\n              <p className=\"text-xs text-gray-500 uppercase tracking-wider font-semibold\">Company</p>\r\n              <p className=\"text-lg font-medium text-gray-900 dark:text-white\">{profile.company?.company_name || '-'}</p>\r\n            </div>\r\n            <div className=\"p-3 bg-gray-50 dark:bg-gray-700/50 rounded-md\">\r\n              <p className=\"text-xs text-gray-500 uppercase tracking-wider font-semibold\">Grade Level</p>\r\n              <p className=\"text-lg font-medium text-gray-900 dark:text-white\">{profile.grade_level || '-'}</p>\r\n            </div>\r\n            <div className=\"p-3 bg-gray-50 dark:bg-gray-700/50 rounded-md\">\r\n              <p className=\"text-xs text-gray-500 uppercase tracking-wider font-semibold\">Room #</p>\r\n              <p className=\"text-lg font-medium text-gray-900 dark:text-white\">{profile.room_number || '-'}</p>\r\n            </div>\r\n            <div className=\"p-3 bg-gray-50 dark:bg-gray-700/50 rounded-md\">\r\n              <p className=\"text-xs text-gray-500 uppercase tracking-wider font-semibold\">Years Attended</p>\r\n              <p className=\"text-lg font-medium text-gray-900 dark:text-white\">{profile.years_attended ?? 0}</p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\r\n        \r\n        {/* Left Column: Status & Conduct */}\r\n        <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6 h-fit\">\r\n          <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-4\">Status & Conduct</h3>\r\n          \r\n          <div className=\"space-y-4\">\r\n            <div>\r\n              <p className=\"text-sm text-gray-500 dark:text-gray-400 mb-1\">Conduct Status</p>\r\n              <span className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-sm font-medium ${\r\n                isGoodConduct \r\n                  ? 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200' \r\n                  : 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200'\r\n              }`}>\r\n                {profile.conduct_status || 'Good Standing'}\r\n              </span>\r\n            </div>\r\n\r\n            <div>\r\n              <p className=\"text-sm text-gray-500 dark:text-gray-400 mb-1\">Probationary Status</p>\r\n              {isProbation ? (\r\n                <span className=\"inline-flex items-center px-2.5 py-0.5 rounded-full text-sm font-medium bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200\">\r\n                  {profile.probation_status}\r\n                </span>\r\n              ) : (\r\n                <span className=\"text-gray-900 dark:text-white font-medium\">None</span>\r\n              )}\r\n            </div>\r\n            \r\n            <div className=\"pt-4 border-t border-gray-100 dark:border-gray-700\">\r\n              <p className=\"text-sm text-gray-500 dark:text-gray-400 mb-1\">Total Demerits (Lifetime)</p>\r\n              <p className=\"text-2xl font-bold text-gray-900 dark:text-white\">{profile.total_demerits}</p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Right Column: Athletics & Info */}\r\n        <div className=\"lg:col-span-2 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6\">\r\n          <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-4\">Athletics & Activities</h3>\r\n          \r\n          <div className=\"grid grid-cols-1 sm:grid-cols-3 gap-4 mb-6\">\r\n            <SportCard title=\"Fall\" sport={profile.sport_fall} active={currentSportData.season === 'Fall Sport'} />\r\n            <SportCard title=\"Winter\" sport={profile.sport_winter} active={currentSportData.season === 'Winter Sport'} />\r\n            {/* Updated to Spring */}\r\n            <SportCard title=\"Spring\" sport={profile.sport_spring} active={currentSportData.season === 'Spring Sport'} />\r\n          </div>\r\n        </div>\r\n\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nfunction SportCard({ title, sport, active }: { title: string, sport: string | null, active: boolean }) {\r\n  return (\r\n    <div className={`p-4 rounded-lg border ${\r\n      active \r\n        ? 'bg-indigo-50 border-indigo-200 dark:bg-indigo-900/20 dark:border-indigo-800 ring-1 ring-indigo-500' \r\n        : 'bg-gray-50 border-gray-200 dark:bg-gray-700/30 dark:border-gray-700'\r\n    }`}>\r\n      <div className=\"flex justify-between items-start\">\r\n        <p className={`text-sm font-semibold ${active ? 'text-indigo-700 dark:text-indigo-300' : 'text-gray-500 dark:text-gray-400'}`}>\r\n          {title}\r\n        </p>\r\n        {active && <span className=\"h-2 w-2 rounded-full bg-indigo-500 animate-pulse\"></span>}\r\n      </div>\r\n      <p className=\"mt-2 text-lg font-medium text-gray-900 dark:text-white\">\r\n        {sport || 'None'}\r\n      </p>\r\n    </div>\r\n  )\r\n}"],"names":[],"mappings":"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","debugId":null}}]
}
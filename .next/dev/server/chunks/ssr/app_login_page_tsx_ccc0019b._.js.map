{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/ckhme/my-workflow-app/app/login/page.tsx"],"sourcesContent":["'use client' \r\n\r\nimport { createClient } from '@/utils/supabase/client'\r\nimport { Auth } from '@supabase/auth-ui-react'\r\nimport { ThemeSupa } from '@supabase/auth-ui-shared'\r\nimport { useEffect, useState } from 'react' \r\nimport { useTheme } from '@/app/components/ThemeProvider'\r\n\r\nexport default function LoginPage() {\r\n  const supabase = createClient()\r\n  const { theme } = useTheme()\r\n  const [showForgotHelp, setShowForgotHelp] = useState(false)\r\n\r\n  // 1. Force Logout on Mount\r\n  // This clears any stale local session data that might cause a redirect loop\r\n  useEffect(() => {\r\n    const doLogout = async () => {\r\n      await supabase.auth.signOut()\r\n    }\r\n    doLogout()\r\n  }, [supabase])\r\n\r\n  // 2. Handle New Sign-Ins\r\n  useEffect(() => {\r\n    const { data: { subscription } } = supabase.auth.onAuthStateChange(\r\n      (event, session) => {\r\n        if (event === 'SIGNED_IN' && session) {\r\n          // Hard refresh to ensure server gets the new cookie\r\n          window.location.replace('/') \r\n        }\r\n        \r\n        if (event === 'PASSWORD_RECOVERY') {\r\n          window.location.replace('/update-password')\r\n        }\r\n      }\r\n    )\r\n    return () => {\r\n      subscription.unsubscribe()\r\n    }\r\n  }, [supabase])\r\n\r\n  return (\r\n    <div style={{ width: '100%', maxWidth: '420px', margin: 'auto', paddingTop: '2rem' }} className=\"p-4\">\r\n      \r\n      <Auth\r\n        supabaseClient={supabase}\r\n        appearance={{ \r\n            theme: ThemeSupa,\r\n            style: {\r\n                anchor: { display: 'none' }, // Hides default links\r\n                button: { borderRadius: '0.375rem' },\r\n                input: { borderRadius: '0.375rem' },\r\n            }\r\n        }}\r\n        theme={theme}\r\n        providers={[]} \r\n      />\r\n\r\n      <div className=\"mt-4 text-center\">\r\n        {!showForgotHelp ? (\r\n            <button \r\n                onClick={() => setShowForgotHelp(true)}\r\n                className=\"text-sm text-gray-500 hover:text-indigo-600 dark:text-gray-400 dark:hover:text-indigo-400 transition-colors hover:underline\"\r\n            >\r\n                Forgot your password?\r\n            </button>\r\n        ) : (\r\n            <div className=\"p-4 bg-gray-50 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 animate-in fade-in slide-in-from-top-2\">\r\n                <p className=\"text-sm text-gray-700 dark:text-gray-300\">\r\n                    Please contact <a href=\"mailto:it@fuma.org\" className=\"text-indigo-600 hover:underline font-medium\">it@fuma.org</a> for password assistance.\r\n                </p>\r\n                <button \r\n                    onClick={() => setShowForgotHelp(false)}\r\n                    className=\"text-xs text-gray-400 hover:text-gray-600 dark:hover:text-gray-200 mt-2 underline\"\r\n                >\r\n                    Close\r\n                </button>\r\n            </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  )\r\n}"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AACA;AANA;;;;;;;AAQe,SAAS;IACtB,MAAM,WAAW,IAAA,2IAAY;IAC7B,MAAM,EAAE,KAAK,EAAE,GAAG,IAAA,+IAAQ;IAC1B,MAAM,CAAC,gBAAgB,kBAAkB,GAAG,IAAA,iNAAQ,EAAC;IAErD,2BAA2B;IAC3B,4EAA4E;IAC5E,IAAA,kNAAS,EAAC;QACR,MAAM,WAAW;YACf,MAAM,SAAS,IAAI,CAAC,OAAO;QAC7B;QACA;IACF,GAAG;QAAC;KAAS;IAEb,yBAAyB;IACzB,IAAA,kNAAS,EAAC;QACR,MAAM,EAAE,MAAM,EAAE,YAAY,EAAE,EAAE,GAAG,SAAS,IAAI,CAAC,iBAAiB,CAChE,CAAC,OAAO;YACN,IAAI,UAAU,eAAe,SAAS;gBACpC,oDAAoD;gBACpD,OAAO,QAAQ,CAAC,OAAO,CAAC;YAC1B;YAEA,IAAI,UAAU,qBAAqB;gBACjC,OAAO,QAAQ,CAAC,OAAO,CAAC;YAC1B;QACF;QAEF,OAAO;YACL,aAAa,WAAW;QAC1B;IACF,GAAG;QAAC;KAAS;IAEb,qBACE,8OAAC;QAAI,OAAO;YAAE,OAAO;YAAQ,UAAU;YAAS,QAAQ;YAAQ,YAAY;QAAO;QAAG,WAAU;;0BAE9F,8OAAC,gLAAI;gBACH,gBAAgB;gBAChB,YAAY;oBACR,OAAO,iLAAS;oBAChB,OAAO;wBACH,QAAQ;4BAAE,SAAS;wBAAO;wBAC1B,QAAQ;4BAAE,cAAc;wBAAW;wBACnC,OAAO;4BAAE,cAAc;wBAAW;oBACtC;gBACJ;gBACA,OAAO;gBACP,WAAW,EAAE;;;;;;0BAGf,8OAAC;gBAAI,WAAU;0BACZ,CAAC,+BACE,8OAAC;oBACG,SAAS,IAAM,kBAAkB;oBACjC,WAAU;8BACb;;;;;yCAID,8OAAC;oBAAI,WAAU;;sCACX,8OAAC;4BAAE,WAAU;;gCAA2C;8CACrC,8OAAC;oCAAE,MAAK;oCAAqB,WAAU;8CAA8C;;;;;;gCAAe;;;;;;;sCAEvH,8OAAC;4BACG,SAAS,IAAM,kBAAkB;4BACjC,WAAU;sCACb;;;;;;;;;;;;;;;;;;;;;;;AAQjB","debugId":null}}]
}
{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/ckhme/my-workflow-app/app/reports/submitted/SubmittedReportsClient.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { useState, useMemo } from 'react'\r\nimport { useRouter } from 'next/navigation'\r\nimport { SubmittedReport } from './page'\r\n\r\ntype SortKey = 'created_at' | 'subject' | 'offense' | 'status';\r\n\r\nexport default function SubmittedReportsClient({ initialReports }: { initialReports: SubmittedReport[] }) {\r\n  const router = useRouter()\r\n  const [search, setSearch] = useState('')\r\n  const [filterStatus, setFilterStatus] = useState<string>('all')\r\n  const [sortConfig, setSortConfig] = useState<{ key: SortKey; direction: 'asc' | 'desc' }>({ key: 'created_at', direction: 'desc' })\r\n\r\n  // Main Logic: Filter -> Sort\r\n  const processedReports = useMemo(() => {\r\n    let result = [...initialReports];\r\n\r\n    // 1. Filter by Search Text\r\n    if (search) {\r\n        const s = search.toLowerCase();\r\n        result = result.filter(r => \r\n          r.subject?.last_name.toLowerCase().includes(s) ||\r\n          r.subject?.first_name.toLowerCase().includes(s) ||\r\n          r.offense_type?.offense_name.toLowerCase().includes(s)\r\n        );\r\n    }\r\n\r\n    // 2. Filter by Status\r\n    if (filterStatus !== 'all') {\r\n        result = result.filter(r => r.status === filterStatus);\r\n    }\r\n\r\n    // 3. Sort\r\n    result.sort((a, b) => {\r\n        let aValue = '';\r\n        let bValue = '';\r\n\r\n        switch (sortConfig.key) {\r\n            case 'created_at':\r\n                return sortConfig.direction === 'asc' \r\n                    ? new Date(a.created_at).getTime() - new Date(b.created_at).getTime()\r\n                    : new Date(b.created_at).getTime() - new Date(a.created_at).getTime();\r\n            case 'subject':\r\n                aValue = a.subject?.last_name || '';\r\n                bValue = b.subject?.last_name || '';\r\n                break;\r\n            case 'offense':\r\n                aValue = a.offense_type?.offense_name || '';\r\n                bValue = b.offense_type?.offense_name || '';\r\n                break;\r\n            case 'status':\r\n                aValue = a.status || '';\r\n                bValue = b.status || '';\r\n                break;\r\n        }\r\n\r\n        if (aValue < bValue) return sortConfig.direction === 'asc' ? -1 : 1;\r\n        if (aValue > bValue) return sortConfig.direction === 'asc' ? 1 : -1;\r\n        return 0;\r\n    });\r\n\r\n    return result;\r\n  }, [initialReports, search, filterStatus, sortConfig]);\r\n\r\n  // Sort Handler\r\n  const requestSort = (key: SortKey) => {\r\n    let direction: 'asc' | 'desc' = 'asc';\r\n    if (sortConfig.key === key && sortConfig.direction === 'asc') {\r\n      direction = 'desc';\r\n    }\r\n    setSortConfig({ key, direction });\r\n  };\r\n\r\n  const SortIcon = ({ active, direction }: { active: boolean, direction: 'asc' | 'desc' }) => {\r\n      if (!active) return <span className=\"ml-1 text-gray-400\">↕</span>;\r\n      return <span className=\"ml-1 text-indigo-600 dark:text-indigo-400\">{direction === 'asc' ? '↑' : '↓'}</span>;\r\n  };\r\n\r\n  const formatName = (p: { first_name: string, last_name: string } | null) => p ? `${p.last_name}, ${p.first_name}` : 'N/A'\r\n  const formatDate = (d: string) => new Date(d).toLocaleDateString()\r\n  \r\n  const getStatusBadge = (status: string) => {\r\n      const styles: Record<string, string> = {\r\n          'completed': 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-100',\r\n          'rejected': 'bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-100',\r\n          'pending_approval': 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-100',\r\n          'needs_revision': 'bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-100',\r\n          'pulled': 'bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-100'\r\n      };\r\n      const displayStatus = status === 'pulled' ? 'Pulled' : status.replace('_', ' ').replace(/\\b\\w/g, l => l.toUpperCase());\r\n      return (\r\n          <span className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${styles[status] || 'bg-gray-100 text-gray-800'}`}>\r\n              {displayStatus}\r\n          </span>\r\n      )\r\n  }\r\n\r\n  const getAppealBadge = (appeals: { status: string }[]) => {\r\n      if (!appeals || appeals.length === 0) return null;\r\n      \r\n      const status = appeals[0].status; \r\n\r\n      if (status === 'approved') {\r\n          return <span className=\"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200\">Appeal Granted</span>\r\n      } else if (status === 'rejected_final') {\r\n          return <span className=\"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200\">Appeal Denied</span>\r\n      } else if (['rejected_by_issuer', 'rejected_by_chain'].includes(status)) {\r\n          return <span className=\"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200\">Appeal Rejected</span>\r\n      } else {\r\n           return <span className=\"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200\">Appeal In Progress</span>\r\n      }\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-4\">\r\n        {/* Controls Bar */}\r\n        <div className=\"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 flex flex-col md:flex-row gap-4\">\r\n            <div className=\"flex-1\">\r\n                <label className=\"block text-xs font-medium text-gray-500 dark:text-gray-400 mb-1\">Search</label>\r\n                <input\r\n                    type=\"text\"\r\n                    placeholder=\"Search cadet or infraction...\"\r\n                    value={search}\r\n                    onChange={(e) => setSearch(e.target.value)}\r\n                    className=\"block w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-900 dark:text-white shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm py-2 px-3\"\r\n                />\r\n            </div>\r\n            <div className=\"w-full md:w-64\">\r\n                <label className=\"block text-xs font-medium text-gray-500 dark:text-gray-400 mb-1\">Filter by Status</label>\r\n                <select\r\n                    value={filterStatus}\r\n                    onChange={(e) => setFilterStatus(e.target.value)}\r\n                    className=\"block w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-900 dark:text-white shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm py-2 px-3\"\r\n                >\r\n                    <option value=\"all\">All Statuses</option>\r\n                    <option value=\"pending_approval\">Pending Approval</option>\r\n                    <option value=\"needs_revision\">Needs Revision</option>\r\n                    <option value=\"completed\">Approved</option>\r\n                    <option value=\"rejected\">Rejected</option>\r\n                    <option value=\"pulled\">Pulled</option>\r\n                </select>\r\n            </div>\r\n        </div>\r\n\r\n      {/* Table */}\r\n      <div className=\"bg-white dark:bg-gray-800 shadow-sm rounded-lg border border-gray-200 dark:border-gray-700 overflow-hidden\">\r\n        <div className=\"overflow-x-auto\">\r\n          <table className=\"min-w-full divide-y divide-gray-200 dark:divide-gray-700\">\r\n            <thead className=\"bg-gray-50 dark:bg-gray-700\">\r\n              <tr>\r\n                <th \r\n                    scope=\"col\" \r\n                    className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600\"\r\n                    onClick={() => requestSort('created_at')}\r\n                >\r\n                    Date <SortIcon active={sortConfig.key === 'created_at'} direction={sortConfig.direction} />\r\n                </th>\r\n                <th \r\n                    scope=\"col\" \r\n                    className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600\"\r\n                    onClick={() => requestSort('subject')}\r\n                >\r\n                    Subject <SortIcon active={sortConfig.key === 'subject'} direction={sortConfig.direction} />\r\n                </th>\r\n                <th \r\n                    scope=\"col\" \r\n                    className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600\"\r\n                    onClick={() => requestSort('offense')}\r\n                >\r\n                    Infraction <SortIcon active={sortConfig.key === 'offense'} direction={sortConfig.direction} />\r\n                </th>\r\n                <th \r\n                    scope=\"col\" \r\n                    className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600\"\r\n                    onClick={() => requestSort('status')}\r\n                >\r\n                    Status <SortIcon active={sortConfig.key === 'status'} direction={sortConfig.direction} />\r\n                </th>\r\n                <th \r\n                    scope=\"col\" \r\n                    className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\"\r\n                >\r\n                    Appeal\r\n                </th>\r\n                {/* Removed Details and View Headers */}\r\n              </tr>\r\n            </thead>\r\n            <tbody className=\"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700\">\r\n              {processedReports.length > 0 ? processedReports.map((report) => (\r\n                <tr \r\n                    key={report.id} \r\n                    onClick={() => router.push(`/report/${report.id}`)} \r\n                    className=\"hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors cursor-pointer\"\r\n                >\r\n                  <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400\">\r\n                    {formatDate(report.created_at)}\r\n                  </td>\r\n                  <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                    <div className=\"text-sm font-medium text-gray-900 dark:text-white\">{formatName(report.subject)}</div>\r\n                  </td>\r\n                  <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                    <div className=\"text-sm text-gray-900 dark:text-white\">{report.offense_type?.offense_name}</div>\r\n                  </td>\r\n                  <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                    {getStatusBadge(report.status)}\r\n                  </td>\r\n                  <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                    {getAppealBadge(report.appeals)}\r\n                  </td>\r\n                  {/* Removed Details and View Cells */}\r\n                </tr>\r\n              )) : (\r\n                <tr>\r\n                  <td colSpan={5} className=\"px-6 py-12 text-center text-gray-500 dark:text-gray-400\">\r\n                    No reports found.\r\n                  </td>\r\n                </tr>\r\n              )}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n        <div className=\"px-6 py-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900/50 text-sm text-gray-500 dark:text-gray-400\">\r\n          Showing {processedReports.length} reports\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}"],"names":[],"mappings":"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","debugId":null}}]
}
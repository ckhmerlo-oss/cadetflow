{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/ckhme/my-workflow-app/app/manage/actions.ts"],"sourcesContent":["'use server'\r\n\r\nimport { createClient } from '@/utils/supabase/server'\r\nimport { revalidatePath } from 'next/cache'\r\n\r\nexport async function updateUserRole(profileId: string, roleId: string | null) {\r\n  const supabase = createClient()\r\n  \r\n  const { error } = await supabase\r\n    .from('profiles')\r\n    .update({ role_id: roleId })\r\n    .eq('id', profileId)\r\n\r\n  if (error) {\r\n    return { error: error.message }\r\n  }\r\n\r\n  revalidatePath('/manage')\r\n  return { success: true }\r\n}"],"names":[],"mappings":";;;;;;;IAKsB,iBAAA,WAAA,GAAA,IAAA,kPAAA,EAAA,8CAAA,uOAAA,EAAA,KAAA,GAAA,6OAAA,EAAA","debugId":null}},
    {"offset": {"line": 19, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/ckhme/my-workflow-app/app/manage/RosterClient.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { useState } from 'react'\r\nimport { useRouter } from 'next/navigation'\r\nimport { updateUserRole } from './actions'\r\n\r\ntype Profile = {\r\n  id: string\r\n  first_name: string\r\n  last_name: string\r\n  role_id: string | null\r\n  role: { role_name: string } | null\r\n}\r\n\r\ntype Role = {\r\n  id: string\r\n  role_name: string\r\n  company: { company_name: string } | null\r\n}\r\n\r\ninterface RosterClientProps {\r\n  initialProfiles: Profile[]\r\n  roles: Role[]\r\n}\r\n\r\nexport default function RosterClient({ initialProfiles, roles }: RosterClientProps) {\r\n  const router = useRouter()\r\n  const [searchTerm, setSearchTerm] = useState('')\r\n  const [isModalOpen, setIsModalOpen] = useState(false)\r\n  const [selectedProfile, setSelectedProfile] = useState<Profile | null>(null)\r\n  const [selectedRoleId, setSelectedRoleId] = useState<string>('')\r\n  const [isSaving, setIsSaving] = useState(false)\r\n\r\n  // --- FILTERING ---\r\n  const filteredProfiles = initialProfiles.filter(p => \r\n    p.last_name.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n    p.first_name.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n    (p.role?.role_name || '').toLowerCase().includes(searchTerm.toLowerCase())\r\n  )\r\n\r\n  // Group roles for the dropdown\r\n  const rolesByCompany = roles.reduce((acc, role) => {\r\n    const companyName = role.company?.company_name || 'Unassigned'\r\n    if (!acc[companyName]) acc[companyName] = []\r\n    acc[companyName].push(role)\r\n    return acc\r\n  }, {} as Record<string, Role[]>)\r\n\r\n  // --- HANDLERS ---\r\n  const handleEditClick = (profile: Profile) => {\r\n    setSelectedProfile(profile)\r\n    setSelectedRoleId(profile.role_id || '')\r\n    setIsModalOpen(true)\r\n  }\r\n\r\n  const handleSave = async () => {\r\n    if (!selectedProfile) return\r\n    setIsSaving(true)\r\n    \r\n    // Convert empty string back to null for database\r\n    const roleIdToSave = selectedRoleId === '' ? null : selectedRoleId\r\n    \r\n    const result = await updateUserRole(selectedProfile.id, roleIdToSave)\r\n    \r\n    if (result.error) {\r\n      alert(`Error: ${result.error}`)\r\n    } else {\r\n      setIsModalOpen(false)\r\n      router.refresh() // Refresh server data\r\n    }\r\n    setIsSaving(false)\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* --- SEARCH BAR --- */}\r\n      <div className=\"relative\">\r\n        <input\r\n          type=\"text\"\r\n          placeholder=\"Search cadets...\"\r\n          value={searchTerm}\r\n          onChange={(e) => setSearchTerm(e.target.value)}\r\n          className=\"block w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-900 dark:text-white shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm py-3 px-4\"\r\n        />\r\n      </div>\r\n\r\n      {/* --- ROSTER TABLE --- */}\r\n      <div className=\"bg-white dark:bg-gray-800 shadow rounded-lg overflow-hidden\">\r\n        <table className=\"min-w-full divide-y divide-gray-200 dark:divide-gray-700\">\r\n          <thead className=\"bg-gray-50 dark:bg-gray-900/50\">\r\n            <tr>\r\n              <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\">Name</th>\r\n              <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\">Current Role</th>\r\n              <th className=\"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\">Action</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody className=\"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700\">\r\n            {filteredProfiles.map((profile) => (\r\n              <tr key={profile.id} className=\"hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors\">\r\n                <td className=\"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white\">\r\n                  {profile.last_name}, {profile.first_name}\r\n                </td>\r\n                <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300\">\r\n                  {profile.role?.role_name || <span className=\"text-gray-400 italic\">Unassigned</span>}\r\n                </td>\r\n                <td className=\"px-6 py-4 whitespace-nowrap text-right text-sm font-medium\">\r\n                  <button \r\n                    onClick={() => handleEditClick(profile)}\r\n                    className=\"text-indigo-600 dark:text-indigo-400 hover:text-indigo-900 dark:hover:text-indigo-300\"\r\n                  >\r\n                    Assign Role\r\n                  </button>\r\n                </td>\r\n              </tr>\r\n            ))}\r\n            {filteredProfiles.length === 0 && (\r\n              <tr>\r\n                <td colSpan={3} className=\"px-6 py-8 text-center text-gray-500 dark:text-gray-400\">\r\n                  No cadets found.\r\n                </td>\r\n              </tr>\r\n            )}\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n\r\n      {/* --- EDIT MODAL --- */}\r\n      {isModalOpen && selectedProfile && (\r\n        <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4\">\r\n          <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full border dark:border-gray-700 flex flex-col max-h-[90vh]\">\r\n            \r\n            <div className=\"p-6 border-b dark:border-gray-700\">\r\n              <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\r\n                Assign Role: {selectedProfile.last_name}, {selectedProfile.first_name}\r\n              </h3>\r\n            </div>\r\n            \r\n            <div className=\"p-6 overflow-y-auto\">\r\n              <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">Select Role</label>\r\n              <select\r\n                value={selectedRoleId}\r\n                onChange={(e) => setSelectedRoleId(e.target.value)}\r\n                className=\"block w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-900 dark:text-white shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm\"\r\n              >\r\n                <option value=\"\">-- No Role (Unassigned) --</option>\r\n                {Object.entries(rolesByCompany).map(([company, companyRoles]) => (\r\n                  <optgroup key={company} label={company}>\r\n                    {companyRoles.map(role => (\r\n                      <option key={role.id} value={role.id}>\r\n                        {role.role_name}\r\n                      </option>\r\n                    ))}\r\n                  </optgroup>\r\n                ))}\r\n              </select>\r\n            </div>\r\n\r\n            <div className=\"p-6 border-t dark:border-gray-700 flex justify-end gap-3 bg-gray-50 dark:bg-gray-900/30 rounded-b-lg\">\r\n              <button\r\n                onClick={() => setIsModalOpen(false)}\r\n                className=\"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700\"\r\n                disabled={isSaving}\r\n              >\r\n                Cancel\r\n              </button>\r\n              <button\r\n                onClick={handleSave}\r\n                className=\"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 disabled:bg-gray-400\"\r\n                disabled={isSaving}\r\n              >\r\n                {isSaving ? 'Saving...' : 'Save Assignment'}\r\n              </button>\r\n            </div>\r\n\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n    </div>\r\n  )\r\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 360, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/ckhme/my-workflow-app/node_modules/next/src/build/webpack/loaders/next-flight-loader/action-client-wrapper.ts"],"sourcesContent":["// This file must be bundled in the app's client layer, it shouldn't be directly\n// imported by the server.\n\nexport { callServer } from 'next/dist/client/app-call-server'\nexport { findSourceMapURL } from 'next/dist/client/app-find-source-map-url'\n\n// A noop wrapper to let the Flight client create the server reference.\n// See also: https://github.com/facebook/react/pull/26632\n// eslint-disable-next-line import/no-extraneous-dependencies\nexport { createServerReference } from 'react-server-dom-webpack/client'\n"],"names":["callServer","createServerReference","findSourceMapURL"],"mappings":"AAAA,gFAAgF;AAChF,0BAA0B;;;;;;;;;;;;;;;;IAEjBA,UAAU,EAAA;eAAVA,eAAAA,UAAU;;IAMVC,qBAAqB,EAAA;eAArBA,QAAAA,qBAAqB;;IALrBC,gBAAgB,EAAA;eAAhBA,qBAAAA,gBAAgB;;;+BADE;qCACM;wBAKK","ignoreList":[0],"debugId":null}}]
}
{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/ckhme/my-workflow-app/app/submit/page.tsx"],"sourcesContent":["// in app/report/[id]/page.tsx\r\n'use client' \r\n\r\nimport { createClient } from '@/utils/supabase/client'\r\nimport { useRouter } from 'next/navigation'\r\nimport { useState, useEffect } from 'react'\r\nimport { User } from '@supabase/supabase-js'\r\nimport React from 'react' \r\n\r\n// --- Types ---\r\ntype Report = {\r\n  id: string;\r\n  status: string;\r\n  notes: string | null;\r\n  submitted_by: string;\r\n  subject_cadet_id: string;\r\n  current_approver_group_id: string | null; \r\n  date_of_offense: string;\r\n  offense_type_id: string;\r\n  demerits_effective: number;\r\n  subject: { first_name: string, last_name: string }; \r\n  submitter: { first_name: string, last_name: string };\r\n  offense_type: {\r\n    offense_name: string;\r\n    offense_code: string;\r\n    demerits: number;\r\n    policy_category: number;\r\n  }\r\n};\r\n\r\ntype Log = {\r\n  id: string;\r\n  action: string;\r\n  comment: string;\r\n  created_at: string;\r\n  actor: { first_name: string, last_name: string } | null; \r\n};\r\n\r\ntype OffenseType = {\r\n  id: string;\r\n  offense_group: string;\r\n  offense_name: string;\r\n  demerits: number;\r\n}\r\n\r\ntype Appeal = {\r\n  id: string;\r\n  status: string;\r\n  justification: string;\r\n  current_assignee_id: string | null;\r\n  current_group_id: string | null;\r\n  issuer_comment: string | null;\r\n  chain_comment: string | null;\r\n  final_comment: string | null;\r\n}\r\n\r\nexport default function ReportDetails({ params: paramsPromise }: { params: Promise<{ id: string }> }) {\r\n  \r\n  const params = React.use(paramsPromise);\r\n  const reportId = params.id;\r\n\r\n  const supabase = createClient()\r\n  const router = useRouter()\r\n\r\n  // --- STATE HOOKS ---\r\n  const [report, setReport] = useState<Report | null>(null)\r\n  const [logs, setLogs] = useState<Log[]>([])\r\n  const [appeal, setAppeal] = useState<Appeal | null>(null)\r\n  const [user, setUser] = useState<User | null>(null)\r\n  const [loading, setLoading] = useState(true)\r\n  const [error, setError] = useState<string | null>(null)\r\n  const [isActionLoading, setActionLoading] = useState(false)\r\n  // Permissions\r\n  const [isSubmitter, setIsSubmitter] = useState(false)\r\n  const [isApprover, setIsApprover] = useState(false)\r\n  const [isSubject, setIsSubject] = useState(false)\r\n  const [canActOnAppeal, setCanActOnAppeal] = useState(false);\r\n  // Form Modes & Inputs\r\n  const [isEditing, setIsEditing] = useState(false);\r\n  const [offenses, setOffenses] = useState<OffenseType[]>([]);\r\n  const [editableOffenseId, setEditableOffenseId] = useState('');\r\n  const [editableNotes, setEditableNotes] = useState('');\r\n  const [editableDate, setEditableDate] = useState('');\r\n  const [isAppealing, setIsAppealing] = useState(false);\r\n  const [isEscalating, setIsEscalating] = useState(false);\r\n  const [appealJustification, setAppealJustification] = useState('');\r\n  const [comment, setComment] = useState('') \r\n  const [appealComment, setAppealComment] = useState('');\r\n\r\n  // --- Helpers ---\r\n  const formatName = (person: { first_name: string, last_name: string } | null) => {\r\n    if (!person) return 'N/A';\r\n    return `${person.last_name}, ${person.first_name.charAt(0)}.`;\r\n  }\r\n  const formatStatus = (status: string) => {\r\n    switch (status) {\r\n      case 'completed': return 'Approved'; case 'rejected': return 'Rejected';\r\n      case 'needs_revision': return 'Revision Requested'; case 'pending_approval': return 'Pending Approval';\r\n      default: return status.replace('_', ' ');\r\n    }\r\n  }\r\n  const formatAppealStatus = (status: string) => {\r\n     switch (status) {\r\n       case 'pending_issuer': return 'Pending Initial Review';\r\n       case 'rejected_by_issuer': return 'Rejected by Issuer (Can Escalate)';\r\n       case 'pending_chain': return 'Pending Chain of Command';\r\n       case 'rejected_by_chain': return 'Rejected by Chain (Can Escalate)';\r\n       case 'pending_commandant': return 'Pending Commandant Review';\r\n       case 'approved': return 'Appeal Granted';\r\n       case 'rejected_final': return 'Appeal Denied (Final)';\r\n       default: return status.replace('_', ' ');\r\n     }\r\n  }\r\n\r\n  // 1. Fetch Data\r\n  useEffect(() => {\r\n    async function getReportData() {\r\n      setLoading(true)\r\n      const { data: { user } } = await supabase.auth.getUser()\r\n      if (!user) { router.push('/login'); return; }\r\n      setUser(user)\r\n\r\n      // A. Fetch Report\r\n      const { data: reportData, error: reportError } = await supabase\r\n        .from('demerit_reports') \r\n        .select(`*, subject:subject_cadet_id ( first_name, last_name ), submitter:submitted_by ( first_name, last_name ), offense_type:offense_type_id ( * )`)\r\n        .eq('id', reportId)\r\n        .single() \r\n\r\n      if (reportError) { setError('Could not load report: ' + reportError.message); setLoading(false); return; }\r\n      setReport(reportData as unknown as Report)\r\n      setIsSubmitter(reportData.submitted_by === user.id)\r\n      setIsSubject(reportData.subject_cadet_id === user.id)\r\n\r\n      // B. Fetch Appeal (if any)\r\n      const { data: appealData } = await supabase\r\n        .from('appeals')\r\n        .select('id, status, justification, current_assignee_id, current_group_id, issuer_comment, chain_comment, final_comment')\r\n        .eq('report_id', reportId)\r\n        .maybeSingle()\r\n      \r\n      if (appealData) setAppeal(appealData as Appeal)\r\n\r\n      // C. Check Appeal Action Permission\r\n      if (appealData && user) {\r\n          if (appealData.status === 'pending_issuer' && appealData.current_assignee_id === user.id) {\r\n              setCanActOnAppeal(true);\r\n          } else if (['pending_chain', 'pending_commandant'].includes(appealData.status) && appealData.current_group_id) {\r\n               const { data: hasPerm } = await supabase.rpc('is_member_of_approver_group', { p_group_id: appealData.current_group_id });\r\n               if (hasPerm) setCanActOnAppeal(true);\r\n          }\r\n      }\r\n\r\n      // D. Fetch Dropdown Data (only if needed for editing)\r\n      if (reportData.submitted_by === user.id && reportData.status === 'needs_revision') {\r\n        const { data: offensesData } = await supabase.from('offense_types').select('*').order('offense_group').order('offense_name')\r\n        if (offensesData) setOffenses(offensesData)\r\n      }\r\n\r\n      // E. Fetch Logs\r\n      const { data: logData } = await supabase.from('approval_log').select('*, actor:actor_id(first_name, last_name)').eq('report_id', reportId).order('created_at', { ascending: false })\r\n      if (logData) setLogs(logData as Log[])\r\n\r\n      // F. Check Approver Status\r\n      if (reportData.current_approver_group_id) {\r\n        const { data: profile } = await supabase.from('profiles').select('roles:role_id(approval_group_id)').eq('id', user.id).single();\r\n        if (profile && (profile.roles as any)?.approval_group_id === reportData.current_approver_group_id) {\r\n           setIsApprover(true);\r\n        }\r\n      }\r\n      setLoading(false)\r\n    }\r\n    getReportData()\r\n  }, [supabase, reportId, router])\r\n\r\n  // --- Actions ---\r\n  async function handleApprovalAction(action: 'approve' | 'reject' | 'kickback') {\r\n    if (!report) return;\r\n    let rpcName = '';\r\n    if (action === 'approve') rpcName = 'handle_approval';\r\n    else if (action === 'reject') rpcName = 'handle_rejection';\r\n    else rpcName = 'handle_kickback';\r\n\r\n    if (!window.confirm(`Are you sure you want to ${action}?`)) return;\r\n    if ((action === 'reject' || action === 'kickback') && !comment) { alert(\"Comment required.\"); return; }\r\n\r\n    setActionLoading(true);\r\n    const payload = action === 'approve' ? { report_id_to_approve: report.id, approval_comment: comment || 'Approved' } : { p_report_id: report.id, p_comment: comment };\r\n    const { error } = await supabase.rpc(rpcName, payload);\r\n\r\n    if (error) { alert(error.message); setActionLoading(false); }\r\n    else { router.push('/'); router.refresh(); }\r\n  }\r\n\r\n  // Edit Report Handlers\r\n  function handleEditClick() {\r\n    if (!report) return;\r\n    setIsEditing(true);\r\n    setEditableOffenseId(report.offense_type_id);\r\n    setEditableNotes(report.notes || '');\r\n    setEditableDate(new Date(report.date_of_offense).toISOString().split('T')[0]);\r\n  }\r\n\r\n  async function handleResubmit(e: React.FormEvent) {\r\n    e.preventDefault(); setActionLoading(true);\r\n    const { error } = await supabase.rpc('resubmit_report', {\r\n      p_report_id: reportId, p_new_offense_type_id: editableOffenseId,\r\n      p_new_notes: editableNotes, p_new_date_of_offense: editableDate\r\n    });\r\n    if (error) { alert(error.message); setActionLoading(false); }\r\n    else { router.push('/'); router.refresh(); }\r\n  }\r\n\r\n  // Appeal Handlers\r\n  async function handleSubmitAppeal(e: React.FormEvent) {\r\n      e.preventDefault();\r\n      if (!appealJustification.trim()) return;\r\n      setActionLoading(true);\r\n      const { error } = await supabase.from('appeals').insert({ report_id: reportId, appealing_cadet_id: user?.id, justification: appealJustification });\r\n      if (error) { alert(error.message); setActionLoading(false); }\r\n      else { alert(\"Appeal submitted.\"); router.refresh(); setIsAppealing(false); }\r\n  }\r\n\r\n  async function handleAppealAction(action: 'grant' | 'reject') {\r\n      if (!appeal) return;\r\n      if (!appealComment.trim()) { alert(\"Please provide a comment.\"); return; }\r\n      setActionLoading(true);\r\n      let rpcName = '';\r\n      if (appeal.status === 'pending_issuer') rpcName = 'appeal_issuer_action';\r\n      else if (appeal.status === 'pending_chain') rpcName = 'appeal_chain_action';\r\n      else if (appeal.status === 'pending_commandant') rpcName = 'appeal_commandant_action';\r\n\r\n      if (rpcName) {\r\n          const { error } = await supabase.rpc(rpcName, { p_appeal_id: appeal.id, p_action: action, p_comment: appealComment });\r\n          if (error) alert(error.message);\r\n          else {\r\n              alert(action === 'grant' ? \"Appeal granted/forwarded.\" : \"Appeal rejected.\");\r\n              router.refresh();\r\n          }\r\n      }\r\n      setActionLoading(false);\r\n  }\r\n\r\n  async function handleEscalate(e: React.FormEvent) {\r\n      e.preventDefault();\r\n      if (!appeal || !appealJustification.trim()) return;\r\n      setActionLoading(true);\r\n      const { error } = await supabase.rpc('escalate_appeal', {\r\n          p_appeal_id: appeal.id,\r\n          p_justification: appealJustification\r\n      });\r\n      if (error) { alert(error.message); setActionLoading(false); }\r\n      else {\r\n          alert(\"Appeal escalated.\");\r\n          setIsEscalating(false);\r\n          router.refresh();\r\n      }\r\n  }\r\n\r\n  // Group offenses for dropdown\r\n  const groupedOffenses = offenses.reduce((acc, o) => { (acc[o.offense_group] = acc[o.offense_group] || []).push(o); return acc; }, {} as Record<string, OffenseType[]>);\r\n\r\n  // --- Render States ---\r\n  if (loading) return <div className=\"p-8 text-center text-gray-500 dark:text-gray-400\">Loading report...</div>\r\n  if (error) return <div className=\"p-8 text-center text-red-600 dark:text-red-400\">{error}</div>\r\n  if (!report) return <div className=\"p-8 text-center text-gray-500 dark:text-gray-400\">Report not found.</div>\r\n\r\n  const showActionBox = isApprover && report.status === 'pending_approval' && !isEditing && !isAppealing;\r\n  const showRevisionBox = isSubmitter && report.status === 'needs_revision' && !isEditing;\r\n  const canAppeal = isSubject && report.status === 'completed' && !appeal && !isAppealing;\r\n  const canEscalate = isSubject && appeal && ['rejected_by_issuer', 'rejected_by_chain'].includes(appeal.status) && !isEscalating;\r\n\r\n  return (\r\n    <div className=\"max-w-4xl mx-auto p-4 sm:p-6 lg:p-8 space-y-6\">\r\n\r\n      {/* --- MODE 1: EDIT REPORT (Submitter) --- */}\r\n      {isEditing ? (\r\n        <div className=\"bg-white dark:bg-gray-800 p-6 rounded-lg shadow\">\r\n          <form onSubmit={handleResubmit} className=\"space-y-6\">\r\n            <h2 className=\"text-2xl font-bold text-gray-900 dark:text-white\">Edit Report</h2>\r\n             <div>\r\n              <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">Date of Offense</label>\r\n              <input type=\"date\" value={editableDate} onChange={e => setEditableDate(e.target.value)} required className=\"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-900 dark:text-white shadow-sm sm:text-sm\" />\r\n            </div>\r\n            <div>\r\n               <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">Offense</label>\r\n               <select value={editableOffenseId} onChange={e => setEditableOffenseId(e.target.value)} required className=\"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-900 dark:text-white shadow-sm sm:text-sm\">\r\n                 {Object.entries(groupedOffenses).map(([group, opts]) => (\r\n                   <optgroup label={group} key={group}>{opts.map(o => <option key={o.id} value={o.id}>({o.demerits}) {o.offense_name}</option>)}</optgroup>\r\n                 ))}\r\n               </select>\r\n            </div>\r\n            <div>\r\n               <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">Notes</label>\r\n               <textarea value={editableNotes} onChange={e => setEditableNotes(e.target.value)} rows={4} className=\"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-900 dark:text-white shadow-sm sm:text-sm\" />\r\n            </div>\r\n            <div className=\"flex gap-4\">\r\n              <button type=\"button\" onClick={() => setIsEditing(false)} disabled={isActionLoading} className=\"w-1/2 py-2 border border-gray-300 dark:border-gray-600 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700\">Cancel</button>\r\n              <button type=\"submit\" disabled={isActionLoading} className=\"w-1/2 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 disabled:bg-gray-400\">{isActionLoading ? 'Saving...' : 'Resubmit'}</button>\r\n            </div>\r\n          </form>\r\n        </div>\r\n      ) \r\n\r\n      /* --- MODE 2a: CREATE APPEAL (Subject) --- */\r\n      : isAppealing ? (\r\n         <div className=\"bg-white dark:bg-gray-800 p-6 rounded-lg shadow border-2 border-indigo-500\">\r\n             <form onSubmit={handleSubmitAppeal} className=\"space-y-6\">\r\n                 <h2 className=\"text-2xl font-bold text-gray-900 dark:text-white\">Appeal this Report</h2>\r\n                 <p className=\"text-sm text-gray-500 dark:text-gray-400\">\r\n                     State your case clearly. This will be sent first to <strong>{formatName(report.submitter)}</strong> for review.\r\n                 </p>\r\n                 <div>\r\n                     <label htmlFor=\"justification\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">Justification / Defense</label>\r\n                     <textarea id=\"justification\" rows={6} required value={appealJustification} onChange={(e) => setAppealJustification(e.target.value)} className=\"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-900 dark:text-white shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm\" placeholder=\"I respectfully appeal this report because...\" />\r\n                 </div>\r\n                 <div className=\"flex gap-4\">\r\n                     <button type=\"button\" onClick={() => setIsAppealing(false)} disabled={isActionLoading} className=\"w-1/2 py-2 border border-gray-300 dark:border-gray-600 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700\">Cancel</button>\r\n                     <button type=\"submit\" disabled={isActionLoading} className=\"w-1/2 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 disabled:bg-gray-400\">{isActionLoading ? 'Submitting...' : 'Submit Appeal'}</button>\r\n                 </div>\r\n             </form>\r\n         </div>\r\n      )\r\n\r\n      /* --- MODE 2b: ESCALATE APPEAL (Subject) --- */\r\n      : isEscalating && appeal ? (\r\n         <div className=\"bg-white dark:bg-gray-800 p-6 rounded-lg shadow border-2 border-yellow-500\">\r\n             <form onSubmit={handleEscalate} className=\"space-y-6\">\r\n                 <h2 className=\"text-2xl font-bold text-gray-900 dark:text-white\">Escalate Appeal</h2>\r\n                 <p className=\"text-sm text-gray-500 dark:text-gray-400\">You are escalating this appeal to the next level in the chain of command.</p>\r\n                 \r\n                 <textarea rows={6} required value={appealJustification} onChange={(e) => setAppealJustification(e.target.value)} className=\"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-900 dark:text-white shadow-sm sm:text-sm\" />\r\n                 <div className=\"flex gap-4\">\r\n                     <button type=\"button\" onClick={() => setIsEscalating(false)} disabled={isActionLoading} className=\"w-1/2 py-2 border border-gray-300 dark:border-gray-600 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700\">Cancel</button>\r\n                     <button type=\"submit\" disabled={isActionLoading} className=\"w-1/2 py-2 bg-yellow-600 text-white rounded-md hover:bg-yellow-700 disabled:bg-gray-400\">{isActionLoading ? 'Escalating...' : 'Confirm Escalation'}</button>\r\n                 </div>\r\n             </form>\r\n         </div>\r\n      )\r\n\r\n      /* --- MODE 3: VIEW REPORT (Default) --- */\r\n      : (\r\n        <div className=\"bg-white dark:bg-gray-800 p-6 rounded-lg shadow\">\r\n          <div className=\"flex flex-col md:flex-row justify-between items-start md:items-center gap-4\">\r\n            <h1 className=\"text-2xl md:text-3xl font-bold text-gray-900 dark:text-white\">{report.offense_type.offense_name}</h1>\r\n            <span className={`px-3 py-1 rounded-full text-sm font-medium ${\r\n                report.status === 'completed' ? 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-100' :\r\n                report.status === 'rejected' ? 'bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-100' :\r\n                report.status === 'pending_approval' ? 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-100' :\r\n                'bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-100'\r\n            }`}>\r\n              {formatStatus(report.status)}\r\n            </span>\r\n          </div>\r\n\r\n          {/* --- APPEAL STATUS & HISTORY RECORD --- */}\r\n          {appeal && (\r\n              <div className=\"mt-6 space-y-4\">\r\n                  {/* Status Banner */}\r\n                  <div className=\"bg-indigo-50 dark:bg-indigo-900/30 border-l-4 border-indigo-500 p-4\">\r\n                      <div className=\"flex justify-between items-center\">\r\n                          <h3 className=\"text-lg font-medium text-indigo-800 dark:text-indigo-200\">Appeal Status</h3>\r\n                          <span className=\"text-sm font-bold text-indigo-900 dark:text-indigo-100 uppercase tracking-wider\">\r\n                              {formatAppealStatus(appeal.status)}\r\n                          </span>\r\n                      </div>\r\n                  </div>\r\n\r\n                  {/* Appeal Thread - Read Only History */}\r\n                  <div className=\"bg-gray-50 dark:bg-gray-900/50 p-4 rounded-lg border dark:border-gray-700 space-y-3\">\r\n                      <h4 className=\"font-medium text-gray-900 dark:text-white mb-2\">Appeal Record</h4>\r\n                      \r\n                      <div className=\"pl-4 border-l-2 border-gray-300 dark:border-gray-600\">\r\n                          <p className=\"text-xs uppercase font-semibold text-gray-500 dark:text-gray-400\">Cadet Justification</p>\r\n                          <p className=\"text-sm text-gray-800 dark:text-gray-200 whitespace-pre-wrap\">{appeal.justification}</p>\r\n                      </div>\r\n\r\n                      {appeal.issuer_comment && (\r\n                          <div className=\"pl-4 border-l-2 border-blue-300 dark:border-blue-600\">\r\n                              <p className=\"text-xs uppercase font-semibold text-blue-600 dark:text-blue-400\">Issuer Note</p>\r\n                              <p className=\"text-sm text-gray-800 dark:text-gray-200\">{appeal.issuer_comment}</p>\r\n                          </div>\r\n                      )}\r\n\r\n                      {appeal.chain_comment && (\r\n                          <div className=\"pl-4 border-l-2 border-purple-300 dark:border-purple-600\">\r\n                              <p className=\"text-xs uppercase font-semibold text-purple-600 dark:text-purple-400\">Chain of Command Note</p>\r\n                              <p className=\"text-sm text-gray-800 dark:text-gray-200\">{appeal.chain_comment}</p>\r\n                          </div>\r\n                      )}\r\n\r\n                      {appeal.final_comment && (\r\n                          <div className={`pl-4 border-l-2 ${appeal.status === 'approved' ? 'border-green-500' : 'border-red-500'}`}>\r\n                              <p className={`text-xs uppercase font-semibold ${appeal.status === 'approved' ? 'text-green-600 dark:text-green-400' : 'text-red-600 dark:text-red-400'}`}>\r\n                                  Final Decision\r\n                              </p>\r\n                              <p className=\"text-sm text-gray-800 dark:text-gray-200\">{appeal.final_comment}</p>\r\n                          </div>\r\n                      )}\r\n                  </div>\r\n              </div>\r\n          )}\r\n\r\n          <div className=\"mt-6 grid grid-cols-1 md:grid-cols-3 gap-6 border-t dark:border-gray-700 pt-6\">\r\n            <div><h3 className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">Subject</h3><p className=\"mt-1 text-lg text-gray-900 dark:text-white\">{formatName(report.subject)}</p></div>\r\n            <div><h3 className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">Submitted By</h3><p className=\"mt-1 text-lg text-gray-900 dark:text-white\">{formatName(report.submitter)}</p></div>\r\n            <div><h3 className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">Date of Offense</h3><p className=\"mt-1 text-lg text-gray-900 dark:text-white\">{new Date(report.date_of_offense).toLocaleDateString()}</p></div>\r\n            <div><h3 className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">Category</h3><p className=\"mt-1 text-lg text-gray-900 dark:text-white\">Cat {report.offense_type.offense_code}</p></div>\r\n            <div>\r\n                <h3 className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">Demerits</h3>\r\n                <p className=\"mt-1 text-lg font-bold text-red-600 dark:text-red-400\">\r\n                    {report.demerits_effective !== report.offense_type.demerits ? (\r\n                        <><span className=\"line-through text-gray-400 mr-2\">{report.offense_type.demerits}</span>{report.demerits_effective}</>\r\n                    ) : (report.demerits_effective)}\r\n                </p>\r\n            </div>\r\n          </div>\r\n\r\n          <h3 className=\"text-lg font-medium text-gray-700 dark:text-gray-300 mt-6\">Notes:</h3>\r\n          <p className=\"mt-2 text-sm text-gray-800 dark:text-gray-200 bg-gray-50 dark:bg-gray-700/50 p-4 rounded-md whitespace-pre-wrap\">\r\n            {report.notes || \"No notes provided.\"}\r\n          </p>\r\n\r\n          {/* --- APPEAL ACTION BOX --- */}\r\n          {canActOnAppeal && !isEditing && (\r\n              <div className=\"mt-6 bg-purple-50 dark:bg-purple-900/20 border border-purple-200 dark:border-purple-700 p-6 rounded-lg shadow-sm\">\r\n                  <h3 className=\"text-lg font-medium text-purple-900 dark:text-purple-100 mb-4\">Appeal Action Required</h3>\r\n                  {/* Removed Justification from here since it's in the record above now */}\r\n                  <textarea placeholder=\"Reason for your decision (this will be visible in the appeal record)...\" value={appealComment} onChange={e => setAppealComment(e.target.value)} className=\"w-full rounded-md border-purple-300 dark:border-purple-600 dark:bg-gray-900 dark:text-white mb-4\" rows={3} />\r\n                  <div className=\"flex gap-4\">\r\n                      <button onClick={() => handleAppealAction('grant')} disabled={isActionLoading} className=\"flex-1 py-2 bg-green-600 text-white rounded hover:bg-green-700 disabled:opacity-50\">\r\n                          {appeal?.status === 'pending_commandant' ? 'Final Approval (Grant Appeal)' : 'Grant & Forward to Next Level'}\r\n                      </button>\r\n                      <button onClick={() => handleAppealAction('reject')} disabled={isActionLoading} className=\"flex-1 py-2 bg-red-600 text-white rounded hover:bg-red-700 disabled:opacity-50\">Reject Appeal</button>\r\n                  </div>\r\n              </div>\r\n          )}\r\n\r\n          {/* --- OPTIONS BUTTONS --- */}\r\n          {(canAppeal || canEscalate) && (\r\n              <div className=\"mt-8 border-t dark:border-gray-700 pt-6\">\r\n                  <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">Options</h3>\r\n                  {canAppeal && (\r\n                     <>\r\n                        <p className=\"mt-1 text-sm text-gray-500 dark:text-gray-400 mb-4\">If you believe this report was issued in error, you may submit an appeal.</p>\r\n                        <button onClick={() => setIsAppealing(true)} className=\"py-2 px-4 border border-indigo-600 text-indigo-600 dark:text-indigo-400 dark:border-indigo-400 rounded-md font-medium hover:bg-indigo-50 dark:hover:bg-indigo-900/30 transition-colors\">Appeal this Report</button>\r\n                     </>\r\n                  )}\r\n                  {canEscalate && (\r\n                      <>\r\n                        <p className=\"mt-1 text-sm text-gray-500 dark:text-gray-400 mb-4\">Your appeal was rejected. You may accept this decision or escalate it.</p>\r\n                        <button onClick={() => { setAppealJustification(appeal?.justification || ''); setIsEscalating(true); }} className=\"py-2 px-4 bg-yellow-600 text-white rounded-md font-medium hover:bg-yellow-700 transition-colors\">Escalate Appeal</button>\r\n                      </>\r\n                  )}\r\n              </div>\r\n          )}\r\n\r\n        </div>\r\n      )}\r\n\r\n      {/* --- STANDARD ACTION BOX (Approver / Submitter Revision) --- */}\r\n      {showActionBox && (\r\n        <div className=\"bg-white dark:bg-gray-800 p-6 rounded-lg shadow\">\r\n          <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">Actions</h3>\r\n          <textarea placeholder=\"Add a comment...\" value={comment} onChange={e => setComment(e.target.value)} className=\"mt-4 mb-4 block w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-900 dark:text-white shadow-sm sm:text-sm\" rows={3} />\r\n          <div className=\"flex flex-col sm:flex-row gap-3\">\r\n            <button onClick={() => handleApprovalAction('approve')} disabled={isActionLoading} className=\"flex-1 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:bg-gray-400\">Approve</button>\r\n            <button onClick={() => handleApprovalAction('kickback')} disabled={isActionLoading} className=\"flex-1 py-2 bg-yellow-600 text-white rounded-md hover:bg-yellow-700 disabled:bg-gray-400\">Kick-back</button>\r\n            <button onClick={() => handleApprovalAction('reject')} disabled={isActionLoading} className=\"flex-1 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 disabled:bg-gray-400\">Reject</button>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {showRevisionBox && (\r\n        <div className=\"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-300 dark:border-yellow-700 p-6 rounded-lg\">\r\n          <h3 className=\"text-lg font-medium text-yellow-800 dark:text-yellow-200\">Needs Revision</h3>\r\n          <button onClick={handleEditClick} className=\"mt-4 py-2 px-4 bg-indigo-600 text-white rounded-md hover:bg-indigo-700\">Edit Report</button>\r\n        </div>\r\n      )}\r\n\r\n      {/* --- HISTORY LOG --- */}\r\n      {!isEditing && !isAppealing && !isEscalating && (\r\n          <div className=\"bg-white dark:bg-gray-800 p-6 rounded-lg shadow\">\r\n            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white mb-4\">History</h3>\r\n            <ul className=\"space-y-4\">\r\n              {logs.length > 0 ? logs.map(log => (\r\n                <li key={log.id} className=\"border-b dark:border-gray-700 pb-4 last:border-0\">\r\n                  <div className=\"flex justify-between\">\r\n                    <span className=\"text-sm font-medium text-gray-900 dark:text-white\"><strong>{formatName(log.actor)}</strong>: {log.action}</span>\r\n                    <span className=\"text-xs text-gray-500 dark:text-gray-400\">{new Date(log.created_at).toLocaleString()}</span>\r\n                  </div>\r\n                  {log.comment && <p className=\"mt-2 text-sm bg-gray-50 dark:bg-gray-700/50 p-2 rounded text-gray-600 dark:text-gray-300\">\"{log.comment}\"</p>}\r\n                </li>\r\n              )) : <p className=\"text-gray-500 dark:text-gray-400\">No history yet.</p>}\r\n            </ul>\r\n          </div>\r\n      )}\r\n\r\n    </div>\r\n  )\r\n}"],"names":[],"mappings":"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","debugId":null}}]
}
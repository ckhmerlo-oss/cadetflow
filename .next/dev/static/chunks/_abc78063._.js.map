{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/ckhme/my-workflow-app/utils/supabase/client.ts"],"sourcesContent":["// in utils/supabase/client.ts\r\nimport { createBrowserClient } from '@supabase/ssr'\r\n\r\nexport function createClient() {\r\n  return createBrowserClient(\r\n    process.env.NEXT_PUBLIC_SUPABASE_URL!,\r\n    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!\r\n  )\r\n}"],"names":[],"mappings":"AAAA,8BAA8B;;;;;AAK1B;AAJJ;AAAA;;AAEO,SAAS;IACd,OAAO,IAAA,oMAAmB;AAI5B","debugId":null}},
    {"offset": {"line": 23, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/ckhme/my-workflow-app/app/submit/page.tsx"],"sourcesContent":["// in app/submit/page.tsx\r\n'use client' // This is an interactive form, so it runs in the browser\r\n\r\nimport { createClient } from '@/utils/supabase/client'\r\nimport { useRouter } from 'next/navigation'\r\nimport { useState, useEffect } from 'react'\r\n\r\n// Define a type for our cadet profile\r\ntype CadetProfile = {\r\n  id: string;\r\n  full_name: string;\r\n}\r\n\r\nexport default function SubmitReport() {\r\n  const supabase = createClient()\r\n  const router = useRouter()\r\n  \r\n  // State for your form fields\r\n  const [title, setTitle] = useState('')\r\n  const [content, setContent] = useState('')\r\n  const [subjectCadetId, setSubjectCadetId] = useState('')\r\n\r\n  // State for your dropdown\r\n  const [cadets, setCadets] = useState<CadetProfile[]>([])\r\n  const [loading, setLoading] = useState(false)\r\n  const [error, setError] = useState<string | null>(null)\r\n\r\n  // 1. Fetch all cadets for the dropdown when the page loads\r\n  useEffect(() => {\r\n    async function getCadets() {\r\n      // Your RLS policy allows any 'authenticated' user to read profiles\r\n      const { data, error } = await supabase\r\n        .from('profiles')\r\n        .select('id, full_name') // Only get what we need\r\n      \r\n      if (error) {\r\n        setError('Could not fetch cadets: ' + error.message)\r\n      } else if (data) {\r\n        setCadets(data)\r\n      }\r\n    }\r\n    getCadets()\r\n  }, [supabase]) // The empty array means this runs once on load\r\n\r\n  // 2. Handle the form submission\r\n  async function handleSubmit(e: React.FormEvent<HTMLFormElement>) {\r\n    e.preventDefault() // Stop the page from refreshing\r\n    setLoading(true)\r\n    setError(null)\r\n\r\n    // 3. Call your 'create_new_report' SQL function\r\n    const { error: rpcError } = await supabase.rpc('create_new_report', {\r\n      title: title,\r\n      subject_cadet_id: subjectCadetId,\r\n      // Make sure your jsonb structure matches what you want.\r\n      // For example, if you just have one text field:\r\n      content: { \"details\": content } \r\n    })\r\n\r\n    setLoading(false)\r\n\r\n    if (rpcError) {\r\n      setError('Error submitting report: ' + rpcError.message)\r\n    } else {\r\n      alert('Report submitted successfully!')\r\n      router.push('/') // Redirect to the dashboard\r\n      router.refresh() // Tell the dashboard to reload its data\r\n    }\r\n  }\r\n\r\n  return (\r\n    <form onSubmit={handleSubmit} style={{ padding: '2em' }}>\r\n      <h2>Submit New Report</h2>\r\n      <div style={{ marginBottom: '1em' }}>\r\n        <label htmlFor=\"title\">Title:</label><br />\r\n        <input \r\n          id=\"title\" \r\n          type=\"text\" \r\n          value={title} \r\n          onChange={(e) => setTitle(e.target.value)} \r\n          required \r\n          style={{ width: '300px' }}\r\n        />\r\n      </div>\r\n\r\n      <div style={{ marginBottom: '1em' }}>\r\n        <label htmlFor=\"cadet\">Subject Cadet:</label><br />\r\n        <select \r\n          id=\"cadet\"\r\n          value={subjectCadetId} \r\n          onChange={(e) => setSubjectCadetId(e.target.value)} \r\n          required\r\n          style={{ width: '300px' }}\r\n        >\r\n          <option value=\"\">Select a cadet</option>\r\n          {cadets.map((cadet) => (\r\n            <option key={cadet.id} value={cadet.id}>\r\n              {cadet.full_name}\r\n            </option>\r\n          ))}\r\n        </select>\r\n      </div>\r\n\r\n      <div style={{ marginBottom: '1em' }}>\r\n        <label htmlFor=\"content\">Report Details:</label><br />\r\n        <textarea \r\n          id=\"content\"\r\n          value={content} \r\n          onChange={(e) => setContent(e.target.value)} \r\n          required \r\n          style={{ width: '300px', minHeight: '100px' }}\r\n        />\r\n      </div>\r\n\r\n      <button type=\"submit\" disabled={loading}>\r\n        {loading ? 'Submitting...' : 'Submit Report'}\r\n      </button>\r\n\r\n      {error && <p style={{ color: 'red' }}>{error}</p>}\r\n    </form>\r\n  )\r\n}"],"names":[],"mappings":"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","debugId":null}}]
}
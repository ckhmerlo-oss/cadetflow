{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/ckhme/my-workflow-app/app/manage/RosterClient.tsx"],"sourcesContent":["'use client'\r\n\r\nimport React, { useState, useMemo } from 'react'\r\nimport Link from 'next/link'\r\nimport { GRADE_LEVELS } from '@/app/profile/constants' // Import grades for filter\r\n\r\n// --- Type Definitions ---\r\ntype RecentReport = {\r\n  id: string;\r\n  offense_name: string;\r\n  status: string;\r\n  created_at: string;\r\n  appeal_status: string | null;\r\n}\r\nexport type RosterCadet = {\r\n  id: string;\r\n  first_name: string;\r\n  last_name: string;\r\n  cadet_rank: string | null;\r\n  company_name: string | null;\r\n  grade_level: string | null;\r\n  room_number: string | null; \r\n  term_demerits: number;\r\n  year_demerits: number;\r\n  current_tour_balance: number;\r\n  has_star_tours: boolean;\r\n  conduct_status: string;\r\n  recent_reports: RecentReport[] | null;\r\n}\r\ntype Company = { id: string; company_name: string }\r\ntype SortKey = keyof RosterCadet;\r\ntype SortDirection = 'ascending' | 'descending';\r\n\r\ntype RosterClientProps = {\r\n  initialData: RosterCadet[]\r\n  canEditProfiles: boolean\r\n  companies: Company[] \r\n}\r\n// --- End Type Definitions ---\r\n\r\nconst CONDUCT_ORDER = [\r\n  'Exemplary',\r\n  'Commendable',\r\n  'Satisfactory',\r\n  'Deficient',\r\n  'Unsatisfactory'\r\n];\r\n\r\nexport default function RosterClient({ initialData, canEditProfiles, companies }: RosterClientProps) {\r\n  const [openCadetId, setOpenCadetId] = useState<string | null>(null)\r\n\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [filterCompany, setFilterCompany] = useState('all');\r\n  const [filterGrade, setFilterGrade] = useState('all');\r\n  const [filterConduct, setFilterConduct] = useState('all');\r\n  const [sortConfig, setSortConfig] = useState<{ key: SortKey, direction: SortDirection }>({ \r\n    key: 'last_name', \r\n    direction: 'ascending' \r\n  });\r\n  \r\n  const handleRowClick = (cadetId: string) => {\r\n    setOpenCadetId(prevId => (prevId === cadetId ? null : cadetId))\r\n  }\r\n\r\n  const filteredAndSortedCadets = useMemo(() => {\r\n    let filteredData = [...initialData];\r\n\r\n    if (searchTerm) {\r\n      const lowerSearch = searchTerm.toLowerCase();\r\n      filteredData = filteredData.filter(cadet =>\r\n        cadet.first_name.toLowerCase().includes(lowerSearch) ||\r\n        cadet.last_name.toLowerCase().includes(lowerSearch) ||\r\n        (cadet.cadet_rank && cadet.cadet_rank.toLowerCase().includes(lowerSearch)) ||\r\n        (cadet.room_number && cadet.room_number.toLowerCase().includes(lowerSearch))\r\n      );\r\n    }\r\n\r\n    if (filterCompany !== 'all') {\r\n      filteredData = filteredData.filter(cadet => cadet.company_name === filterCompany);\r\n    }\r\n    if (filterGrade !== 'all') {\r\n      filteredData = filteredData.filter(cadet => cadet.grade_level === filterGrade);\r\n    }\r\n    if (filterConduct !== 'all') {\r\n      filteredData = filteredData.filter(cadet => cadet.conduct_status === filterConduct);\r\n    }\r\n\r\n    filteredData.sort((a, b) => {\r\n      const aValue = a[sortConfig.key];\r\n      const bValue = b[sortConfig.key];\r\n\r\n      if (aValue == null) return 1;\r\n      if (bValue == null) return -1;\r\n\r\n      if (aValue < bValue) {\r\n        return sortConfig.direction === 'ascending' ? -1 : 1;\r\n      }\r\n      if (aValue > bValue) {\r\n        return sortConfig.direction === 'ascending' ? 1 : -1;\r\n      }\r\n      return 0;\r\n    });\r\n\r\n    return filteredData;\r\n  }, [initialData, searchTerm, filterCompany, filterGrade, filterConduct, sortConfig]);\r\n\r\n  const requestSort = (key: SortKey) => {\r\n    let direction: SortDirection = 'ascending';\r\n    if (sortConfig.key === key && sortConfig.direction === 'ascending') {\r\n      direction = 'descending';\r\n    }\r\n    setSortConfig({ key, direction });\r\n  };\r\n  \r\n  const getSortIndicator = (key: SortKey) => {\r\n    if (sortConfig.key !== key) return null;\r\n    return sortConfig.direction === 'ascending' ? ' ▲' : ' ▼';\r\n  };\r\n\r\n  const getConductColor = (status: string) => {\r\n      if (status === 'Exemplary') return 'bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200';\r\n      if (status === 'Commendable') return 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200';\r\n      if (status === 'Satisfactory') return 'bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200';\r\n      if (status === 'Deficient') return 'bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200';\r\n      return 'bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200';\r\n  }\r\n\r\n  const getAppealBadge = (status: string | null) => {\r\n    if (!status) return null;\r\n    \r\n    switch (status) {\r\n      case 'approved':\r\n        return <span className=\"ml-2 px-2 py-0.5 rounded text-xs font-medium bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200\">Granted</span>;\r\n      case 'rejected_final':\r\n        return <span className=\"ml-2 px-2 py-0.5 rounded text-xs font-medium bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200\">Denied</span>;\r\n      case 'pending_issuer':\r\n      case 'pending_chain':\r\n      case 'pending_commandant':\r\n        return <span className=\"ml-2 px-2 py-0.5 rounded text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200\">Pending</span>;\r\n      default:\r\n        return null;\r\n    }\r\n  }\r\n\r\n  // <<< NEW: Helper for recent report status >>>\r\n  const getRecentReportStatus = (report: RecentReport) => {\r\n    const status = report.status;\r\n    if (status === 'pulled') return <span className=\"text-xs text-gray-500 dark:text-gray-400\">Pulled</span>\r\n    if (status === 'rejected') return <span className=\"text-xs text-red-600 dark:text-red-400\">Rejected</span>\r\n    if (status === 'completed') return <span className=\"text-xs text-green-600 dark:text-green-400\">Approved</span>\r\n    return <span className=\"text-xs text-yellow-600 dark:text-yellow-400\">{status.replace('_', ' ')}</span>\r\n  }\r\n\r\n  const formatTimeAgo = (dateStr: string) => {\r\n    const date = new Date(dateStr)\r\n    const now = new Date()\r\n    const seconds = Math.floor((now.getTime() - date.getTime()) / 1000)\r\n    \r\n    let interval = seconds / 31536000;\r\n    if (interval > 1) return Math.floor(interval) + \"y ago\";\r\n    interval = seconds / 2592000;\r\n    if (interval > 1) return Math.floor(interval) + \"mo ago\";\r\n    interval = seconds / 86400;\r\n    if (interval > 1) return Math.floor(interval) + \"d ago\";\r\n    interval = seconds / 3600;\r\n    if (interval > 1) return Math.floor(interval) + \"h ago\";\r\n    interval = seconds / 60;\r\n    if (interval > 1) return Math.floor(interval) + \"m ago\";\r\n    return Math.floor(seconds) + \"s ago\";\r\n  }\r\n\r\n  const uniqueCompanies = useMemo(() => \r\n    [...new Set(initialData.map(c => c.company_name).filter((c): c is string => !!c).sort())], \r\n  [initialData]);\r\n  \r\n  const uniqueGrades = useMemo(() => \r\n    [...new Set(initialData.map(c => c.grade_level).filter((g): g is string => !!g).sort())], \r\n  [initialData]);\r\n  \r\n  const uniqueConducts = useMemo(() => {\r\n    const presentStatuses = new Set(initialData.map(c => c.conduct_status));\r\n    return CONDUCT_ORDER.filter(status => presentStatuses.has(status));\r\n  }, [initialData]);\r\n\r\n  return (\r\n    <div className=\"bg-white dark:bg-gray-800 shadow-sm border border-gray-200 dark:border-gray-700 rounded-lg overflow-hidden\">\r\n      \r\n      <div className=\"p-4 grid grid-cols-1 md:grid-cols-4 gap-4 border-b border-gray-200 dark:border-gray-700 no-print\">\r\n        <input\r\n          type=\"text\"\r\n          value={searchTerm}\r\n          onChange={(e) => setSearchTerm(e.target.value)}\r\n          placeholder=\"Search by name, rank, room...\"\r\n          className=\"w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-800 dark:text-white\"\r\n        />\r\n        <select\r\n          value={filterCompany}\r\n          onChange={(e) => setFilterCompany(e.target.value)}\r\n          className=\"w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-800 dark:text-white\"\r\n        >\r\n          <option value=\"all\">All Companies</option>\r\n          {uniqueCompanies.map(co => <option key={co} value={co}>{co}</option>)}\r\n        </select>\r\n        <select\r\n          value={filterGrade}\r\n          onChange={(e) => setFilterGrade(e.target.value)}\r\n          className=\"w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-800 dark:text-white\"\r\n        >\r\n          <option value=\"all\">All Grades</option>\r\n          {uniqueGrades.map(g => <option key={g} value={g}>{g}</option>)}\r\n        </select>\r\n        <select\r\n          value={filterConduct}\r\n          onChange={(e) => setFilterConduct(e.target.value)}\r\n          className=\"w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-800 dark:text-white\"\r\n        >\r\n          <option value=\"all\">All Conduct</option>\r\n          {uniqueConducts.map(c => <option key={c} value={c}>{c}</option>)}\r\n        </select>\r\n      </div>\r\n\r\n      <table className=\"min-w-full divide-y divide-gray-200 dark:divide-gray-700 printable-table\">\r\n        <thead className=\"bg-gray-50 dark:bg-gray-700/50\">\r\n          <tr>\r\n            <th scope=\"col\" className=\"px-6 py-3 text-left text-xs font-bold text-gray-600 dark:text-gray-300 uppercase tracking-wider cursor-pointer\" onClick={() => requestSort('cadet_rank')}>\r\n              Rank {getSortIndicator('cadet_rank')}\r\n            </th>\r\n            <th scope=\"col\" className=\"px-6 py-3 text-left text-xs font-bold text-gray-600 dark:text-gray-300 uppercase tracking-wider cursor-pointer\" onClick={() => requestSort('last_name')}>\r\n              Name {getSortIndicator('last_name')}\r\n            </th>\r\n            <th scope=\"col\" className=\"px-6 py-3 text-left text-xs font-bold text-gray-600 dark:text-gray-300 uppercase tracking-wider cursor-pointer\" onClick={() => requestSort('company_name')}>\r\n              Company {getSortIndicator('company_name')}\r\n            </th>\r\n            <th scope=\"col\" className=\"px-6 py-3 text-left text-xs font-bold text-gray-600 dark:text-gray-300 uppercase tracking-wider cursor-pointer\" onClick={() => requestSort('grade_level')}>\r\n              Grade {getSortIndicator('grade_level')}\r\n            </th>\r\n            <th scope=\"col\" className=\"px-6 py-3 text-left text-xs font-bold text-gray-600 dark:text-gray-300 uppercase tracking-wider cursor-pointer\" onClick={() => requestSort('room_number')}>\r\n              Room # {getSortIndicator('room_number')}\r\n            </th>\r\n            <th scope=\"col\" className=\"px-6 py-3 text-left text-xs font-bold text-gray-600 dark:text-gray-300 uppercase tracking-wider cursor-pointer\" onClick={() => requestSort('conduct_status')}>\r\n              Conduct {getSortIndicator('conduct_status')}\r\n            </th>\r\n            <th scope=\"col\" className=\"relative px-6 py-3 print-hide\"><span className=\"sr-only\">Expand</span></th>\r\n          </tr>\r\n        </thead>\r\n        <tbody className=\"divide-y divide-gray-200 dark:divide-gray-700\">\r\n          {filteredAndSortedCadets.map((cadet) => (\r\n            <React.Fragment key={cadet.id}>\r\n              <tr \r\n                onClick={() => handleRowClick(cadet.id)}\r\n                className=\"hover:bg-gray-50 dark:hover:bg-gray-700/50 cursor-pointer transition-colors\"\r\n              >\r\n                <td className=\"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800 dark:text-gray-200\">{cadet.cadet_rank || '-'}</td>\r\n                <td className=\"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white\">{cadet.last_name}, {cadet.first_name}</td>\r\n                <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-400\">{cadet.company_name || '-'}</td>\r\n                <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-400\">{cadet.grade_level || '-'}</td>\r\n                <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-400\">{cadet.room_number || '-'}</td>\r\n                <td className=\"px-6 py-4 whitespace-nowrap text-sm\">\r\n                  <span className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-bold ${getConductColor(cadet.conduct_status)}`}>\r\n                    {cadet.conduct_status}\r\n                  </span>\r\n                </td>\r\n                <td className=\"px-6 py-4 whitespace-nowrap text-right text-sm font-medium print-hide\">\r\n                  <span className=\"text-indigo-600 dark:text-indigo-400\">\r\n                    {openCadetId === cadet.id ? 'Hide' : 'Details'}\r\n                  </span>\r\n                </td>\r\n              </tr>\r\n              {/* Accordion Dropdown Content */}\r\n              {openCadetId === cadet.id && (\r\n                <tr key={`${cadet.id}-dropdown`} className=\"bg-gray-50 dark:bg-gray-700/30 print-hide\">\r\n                  <td colSpan={7} className=\"px-6 py-4\">\r\n                    <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\r\n                      \r\n                      {/* Key Metrics */}\r\n                      <div className=\"space-y-3\">\r\n                        <h4 className=\"text-sm font-bold text-gray-700 dark:text-gray-300 uppercase tracking-wider\">Key Metrics</h4>\r\n                        <div className=\"flex justify-between p-3 bg-white dark:bg-gray-700 rounded-lg border border-gray-200 dark:border-gray-600\">\r\n                          <span className=\"text-sm font-medium text-gray-600 dark:text-gray-400\">Term Demerits</span>\r\n                          <span className=\"text-sm font-bold text-gray-900 dark:text-white\">{cadet.term_demerits}</span>\r\n                        </div>\r\n                        <div className=\"flex justify-between p-3 bg-white dark:bg-gray-700 rounded-lg border border-gray-200 dark:border-gray-600\">\r\n                          <span className=\"text-sm font-medium text-gray-600 dark:text-gray-400\">Year Demerits</span>\r\n                          <span className=\"text-sm font-bold text-gray-900 dark:text-white\">{cadet.year_demerits}</span>\r\n                        </div>\r\n                        <div className=\"flex justify-between p-3 bg-white dark:bg-gray-700 rounded-lg border border-gray-200 dark:border-gray-600\">\r\n                          <span className=\"text-sm font-medium text-gray-600 dark:text-gray-400\">Tour Balance</span>\r\n                          <span className={`text-sm font-bold ${cadet.has_star_tours || cadet.current_tour_balance > 0 ? 'text-red-600 dark:text-red-400' : 'text-gray-900 dark:text-white'}`}>\r\n                            {cadet.has_star_tours ? '*' : cadet.current_tour_balance}\r\n                          </span>\r\n                        </div>\r\n                      </div>\r\n\r\n                      {/* Recent Items */}\r\n                      <div className=\"space-y-3\">\r\n                        <h4 className=\"text-sm font-bold text-gray-700 dark:text-gray-300 uppercase tracking-wider\">Recent Reports</h4>\r\n                        {cadet.recent_reports && cadet.recent_reports.length > 0 ? (\r\n                          <div className=\"p-3 bg-white dark:bg-gray-700 rounded-lg border border-gray-200 dark:border-gray-600 space-y-2\">\r\n                            {cadet.recent_reports.map((report: RecentReport) => (\r\n                              <div key={report.id} className=\"flex justify-between items-center text-sm\">\r\n                                <div>\r\n                                  <p className={`font-medium text-gray-800 dark:text-gray-200 flex items-center ${report.status === 'pulled' ? 'line-through' : ''}`}>\r\n                                    {report.offense_name || 'Report'}\r\n                                    {/* <<< RENDER APPEAL BADGE >>> */}\r\n                                    {getAppealBadge(report.appeal_status)}\r\n                                  </p>\r\n                                  {/* <<< RENDER STATUS PILL >>> */}\r\n                                  <p>{getRecentReportStatus(report)}</p>\r\n                                </div>\r\n                                <span className=\"text-xs text-gray-500 dark:text-gray-400\">{formatTimeAgo(report.created_at)}</span>\r\n                              </div>\r\n                            ))}\r\n                          </div>\r\n                        ) : (\r\n                          <p className=\"text-sm text-gray-500 dark:text-gray-400 italic\">No recent reports found.</p>\r\n                        )}\r\n                      </div>\r\n                      \r\n                      {/* Actions */}\r\n                      <div className=\"space-y-3\">\r\n                        <h4 className=\"text-sm font-bold text-gray-700 dark:text-gray-300 uppercase tracking-wider\">Actions</h4>\r\n                        <div className=\"flex flex-col gap-2\">\r\n                          <Link href={`/profile/${cadet.id}`} className=\"w-full text-center px-4 py-2 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-200 text-sm font-medium rounded-md shadow-sm hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors\">\r\n                            View Full Profile\r\n                          </Link>\r\n                          <Link href={`/ledger/${cadet.id}`} className=\"w-full text-center px-4 py-2 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-200 text-sm font-medium rounded-md shadow-sm hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors\">\r\n                            View Full Ledger\r\n                          </Link>\r\n                          {canEditProfiles && (\r\n                            <Link href={`/profile/${cadet.id}`} className=\"w-full text-center px-4 py-2 bg-indigo-50 dark:bg-indigo-900/20 border border-indigo-200 dark:border-indigo-700 text-indigo-700 dark:text-indigo-300 text-sm font-medium rounded-md shadow-sm hover:bg-indigo-100 dark:hover:bg-indigo-900/40 transition-colors\">\r\n                              Edit Profile\r\n                            </Link>\r\n                          )}\r\n                        </div>\r\n                      </div>\r\n\r\n                    </div>\r\n                  </td>\r\n                </tr>\r\n              )}\r\n            </React.Fragment>\r\n          ))}\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n  )\r\n}"],"names":[],"mappings":";;;;;AAEA;AACA;;;AAHA;;;AAsCA,+BAA+B;AAE/B,MAAM,gBAAgB;IACpB;IACA;IACA;IACA;IACA;CACD;AAEc,SAAS,aAAa,EAAE,WAAW,EAAE,eAAe,EAAE,SAAS,EAAqB;;IACjG,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,yKAAQ,EAAgB;IAE9D,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,yKAAQ,EAAC;IAC7C,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,yKAAQ,EAAC;IACnD,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,yKAAQ,EAAC;IAC/C,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,yKAAQ,EAAC;IACnD,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,yKAAQ,EAA6C;QACvF,KAAK;QACL,WAAW;IACb;IAEA,MAAM,iBAAiB,CAAC;QACtB,eAAe,CAAA,SAAW,WAAW,UAAU,OAAO;IACxD;IAEA,MAAM,0BAA0B,IAAA,wKAAO;yDAAC;YACtC,IAAI,eAAe;mBAAI;aAAY;YAEnC,IAAI,YAAY;gBACd,MAAM,cAAc,WAAW,WAAW;gBAC1C,eAAe,aAAa,MAAM;qEAAC,CAAA,QACjC,MAAM,UAAU,CAAC,WAAW,GAAG,QAAQ,CAAC,gBACxC,MAAM,SAAS,CAAC,WAAW,GAAG,QAAQ,CAAC,gBACtC,MAAM,UAAU,IAAI,MAAM,UAAU,CAAC,WAAW,GAAG,QAAQ,CAAC,gBAC5D,MAAM,WAAW,IAAI,MAAM,WAAW,CAAC,WAAW,GAAG,QAAQ,CAAC;;YAEnE;YAEA,IAAI,kBAAkB,OAAO;gBAC3B,eAAe,aAAa,MAAM;qEAAC,CAAA,QAAS,MAAM,YAAY,KAAK;;YACrE;YACA,IAAI,gBAAgB,OAAO;gBACzB,eAAe,aAAa,MAAM;qEAAC,CAAA,QAAS,MAAM,WAAW,KAAK;;YACpE;YACA,IAAI,kBAAkB,OAAO;gBAC3B,eAAe,aAAa,MAAM;qEAAC,CAAA,QAAS,MAAM,cAAc,KAAK;;YACvE;YAEA,aAAa,IAAI;iEAAC,CAAC,GAAG;oBACpB,MAAM,SAAS,CAAC,CAAC,WAAW,GAAG,CAAC;oBAChC,MAAM,SAAS,CAAC,CAAC,WAAW,GAAG,CAAC;oBAEhC,IAAI,UAAU,MAAM,OAAO;oBAC3B,IAAI,UAAU,MAAM,OAAO,CAAC;oBAE5B,IAAI,SAAS,QAAQ;wBACnB,OAAO,WAAW,SAAS,KAAK,cAAc,CAAC,IAAI;oBACrD;oBACA,IAAI,SAAS,QAAQ;wBACnB,OAAO,WAAW,SAAS,KAAK,cAAc,IAAI,CAAC;oBACrD;oBACA,OAAO;gBACT;;YAEA,OAAO;QACT;wDAAG;QAAC;QAAa;QAAY;QAAe;QAAa;QAAe;KAAW;IAEnF,MAAM,cAAc,CAAC;QACnB,IAAI,YAA2B;QAC/B,IAAI,WAAW,GAAG,KAAK,OAAO,WAAW,SAAS,KAAK,aAAa;YAClE,YAAY;QACd;QACA,cAAc;YAAE;YAAK;QAAU;IACjC;IAEA,MAAM,mBAAmB,CAAC;QACxB,IAAI,WAAW,GAAG,KAAK,KAAK,OAAO;QACnC,OAAO,WAAW,SAAS,KAAK,cAAc,OAAO;IACvD;IAEA,MAAM,kBAAkB,CAAC;QACrB,IAAI,WAAW,aAAa,OAAO;QACnC,IAAI,WAAW,eAAe,OAAO;QACrC,IAAI,WAAW,gBAAgB,OAAO;QACtC,IAAI,WAAW,aAAa,OAAO;QACnC,OAAO;IACX;IAEA,MAAM,iBAAiB,CAAC;QACtB,IAAI,CAAC,QAAQ,OAAO;QAEpB,OAAQ;YACN,KAAK;gBACH,qBAAO,6LAAC;oBAAK,WAAU;8BAAqH;;;;;;YAC9I,KAAK;gBACH,qBAAO,6LAAC;oBAAK,WAAU;8BAAyG;;;;;;YAClI,KAAK;YACL,KAAK;YACL,KAAK;gBACH,qBAAO,6LAAC;oBAAK,WAAU;8BAA6G;;;;;;YACtI;gBACE,OAAO;QACX;IACF;IAEA,+CAA+C;IAC/C,MAAM,wBAAwB,CAAC;QAC7B,MAAM,SAAS,OAAO,MAAM;QAC5B,IAAI,WAAW,UAAU,qBAAO,6LAAC;YAAK,WAAU;sBAA2C;;;;;;QAC3F,IAAI,WAAW,YAAY,qBAAO,6LAAC;YAAK,WAAU;sBAAyC;;;;;;QAC3F,IAAI,WAAW,aAAa,qBAAO,6LAAC;YAAK,WAAU;sBAA6C;;;;;;QAChG,qBAAO,6LAAC;YAAK,WAAU;sBAAgD,OAAO,OAAO,CAAC,KAAK;;;;;;IAC7F;IAEA,MAAM,gBAAgB,CAAC;QACrB,MAAM,OAAO,IAAI,KAAK;QACtB,MAAM,MAAM,IAAI;QAChB,MAAM,UAAU,KAAK,KAAK,CAAC,CAAC,IAAI,OAAO,KAAK,KAAK,OAAO,EAAE,IAAI;QAE9D,IAAI,WAAW,UAAU;QACzB,IAAI,WAAW,GAAG,OAAO,KAAK,KAAK,CAAC,YAAY;QAChD,WAAW,UAAU;QACrB,IAAI,WAAW,GAAG,OAAO,KAAK,KAAK,CAAC,YAAY;QAChD,WAAW,UAAU;QACrB,IAAI,WAAW,GAAG,OAAO,KAAK,KAAK,CAAC,YAAY;QAChD,WAAW,UAAU;QACrB,IAAI,WAAW,GAAG,OAAO,KAAK,KAAK,CAAC,YAAY;QAChD,WAAW,UAAU;QACrB,IAAI,WAAW,GAAG,OAAO,KAAK,KAAK,CAAC,YAAY;QAChD,OAAO,KAAK,KAAK,CAAC,WAAW;IAC/B;IAEA,MAAM,kBAAkB,IAAA,wKAAO;iDAAC,IAC9B;mBAAI,IAAI,IAAI,YAAY,GAAG;6DAAC,CAAA,IAAK,EAAE,YAAY;4DAAE,MAAM;6DAAC,CAAC,IAAmB,CAAC,CAAC;4DAAG,IAAI;aAAI;gDAC3F;QAAC;KAAY;IAEb,MAAM,eAAe,IAAA,wKAAO;8CAAC,IAC3B;mBAAI,IAAI,IAAI,YAAY,GAAG;0DAAC,CAAA,IAAK,EAAE,WAAW;yDAAE,MAAM;0DAAC,CAAC,IAAmB,CAAC,CAAC;yDAAG,IAAI;aAAI;6CAC1F;QAAC;KAAY;IAEb,MAAM,iBAAiB,IAAA,wKAAO;gDAAC;YAC7B,MAAM,kBAAkB,IAAI,IAAI,YAAY,GAAG;wDAAC,CAAA,IAAK,EAAE,cAAc;;YACrE,OAAO,cAAc,MAAM;wDAAC,CAAA,SAAU,gBAAgB,GAAG,CAAC;;QAC5D;+CAAG;QAAC;KAAY;IAEhB,qBACE,6LAAC;QAAI,WAAU;;0BAEb,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBACC,MAAK;wBACL,OAAO;wBACP,UAAU,CAAC,IAAM,cAAc,EAAE,MAAM,CAAC,KAAK;wBAC7C,aAAY;wBACZ,WAAU;;;;;;kCAEZ,6LAAC;wBACC,OAAO;wBACP,UAAU,CAAC,IAAM,iBAAiB,EAAE,MAAM,CAAC,KAAK;wBAChD,WAAU;;0CAEV,6LAAC;gCAAO,OAAM;0CAAM;;;;;;4BACnB,gBAAgB,GAAG,CAAC,CAAA,mBAAM,6LAAC;oCAAgB,OAAO;8CAAK;mCAAhB;;;;;;;;;;;kCAE1C,6LAAC;wBACC,OAAO;wBACP,UAAU,CAAC,IAAM,eAAe,EAAE,MAAM,CAAC,KAAK;wBAC9C,WAAU;;0CAEV,6LAAC;gCAAO,OAAM;0CAAM;;;;;;4BACnB,aAAa,GAAG,CAAC,CAAA,kBAAK,6LAAC;oCAAe,OAAO;8CAAI;mCAAd;;;;;;;;;;;kCAEtC,6LAAC;wBACC,OAAO;wBACP,UAAU,CAAC,IAAM,iBAAiB,EAAE,MAAM,CAAC,KAAK;wBAChD,WAAU;;0CAEV,6LAAC;gCAAO,OAAM;0CAAM;;;;;;4BACnB,eAAe,GAAG,CAAC,CAAA,kBAAK,6LAAC;oCAAe,OAAO;8CAAI;mCAAd;;;;;;;;;;;;;;;;;0BAI1C,6LAAC;gBAAM,WAAU;;kCACf,6LAAC;wBAAM,WAAU;kCACf,cAAA,6LAAC;;8CACC,6LAAC;oCAAG,OAAM;oCAAM,WAAU;oCAAiH,SAAS,IAAM,YAAY;;wCAAe;wCAC7K,iBAAiB;;;;;;;8CAEzB,6LAAC;oCAAG,OAAM;oCAAM,WAAU;oCAAiH,SAAS,IAAM,YAAY;;wCAAc;wCAC5K,iBAAiB;;;;;;;8CAEzB,6LAAC;oCAAG,OAAM;oCAAM,WAAU;oCAAiH,SAAS,IAAM,YAAY;;wCAAiB;wCAC5K,iBAAiB;;;;;;;8CAE5B,6LAAC;oCAAG,OAAM;oCAAM,WAAU;oCAAiH,SAAS,IAAM,YAAY;;wCAAgB;wCAC7K,iBAAiB;;;;;;;8CAE1B,6LAAC;oCAAG,OAAM;oCAAM,WAAU;oCAAiH,SAAS,IAAM,YAAY;;wCAAgB;wCAC5K,iBAAiB;;;;;;;8CAE3B,6LAAC;oCAAG,OAAM;oCAAM,WAAU;oCAAiH,SAAS,IAAM,YAAY;;wCAAmB;wCAC9K,iBAAiB;;;;;;;8CAE5B,6LAAC;oCAAG,OAAM;oCAAM,WAAU;8CAAgC,cAAA,6LAAC;wCAAK,WAAU;kDAAU;;;;;;;;;;;;;;;;;;;;;;kCAGxF,6LAAC;wBAAM,WAAU;kCACd,wBAAwB,GAAG,CAAC,CAAC,sBAC5B,6LAAC,wKAAK,CAAC,QAAQ;;kDACb,6LAAC;wCACC,SAAS,IAAM,eAAe,MAAM,EAAE;wCACtC,WAAU;;0DAEV,6LAAC;gDAAG,WAAU;0DAAoF,MAAM,UAAU,IAAI;;;;;;0DACtH,6LAAC;gDAAG,WAAU;;oDAAiF,MAAM,SAAS;oDAAC;oDAAG,MAAM,UAAU;;;;;;;0DAClI,6LAAC;gDAAG,WAAU;0DAAwE,MAAM,YAAY,IAAI;;;;;;0DAC5G,6LAAC;gDAAG,WAAU;0DAAwE,MAAM,WAAW,IAAI;;;;;;0DAC3G,6LAAC;gDAAG,WAAU;0DAAwE,MAAM,WAAW,IAAI;;;;;;0DAC3G,6LAAC;gDAAG,WAAU;0DACZ,cAAA,6LAAC;oDAAK,WAAW,CAAC,sEAAsE,EAAE,gBAAgB,MAAM,cAAc,GAAG;8DAC9H,MAAM,cAAc;;;;;;;;;;;0DAGzB,6LAAC;gDAAG,WAAU;0DACZ,cAAA,6LAAC;oDAAK,WAAU;8DACb,gBAAgB,MAAM,EAAE,GAAG,SAAS;;;;;;;;;;;;;;;;;oCAK1C,gBAAgB,MAAM,EAAE,kBACvB,6LAAC;wCAAgC,WAAU;kDACzC,cAAA,6LAAC;4CAAG,SAAS;4CAAG,WAAU;sDACxB,cAAA,6LAAC;gDAAI,WAAU;;kEAGb,6LAAC;wDAAI,WAAU;;0EACb,6LAAC;gEAAG,WAAU;0EAA8E;;;;;;0EAC5F,6LAAC;gEAAI,WAAU;;kFACb,6LAAC;wEAAK,WAAU;kFAAuD;;;;;;kFACvE,6LAAC;wEAAK,WAAU;kFAAmD,MAAM,aAAa;;;;;;;;;;;;0EAExF,6LAAC;gEAAI,WAAU;;kFACb,6LAAC;wEAAK,WAAU;kFAAuD;;;;;;kFACvE,6LAAC;wEAAK,WAAU;kFAAmD,MAAM,aAAa;;;;;;;;;;;;0EAExF,6LAAC;gEAAI,WAAU;;kFACb,6LAAC;wEAAK,WAAU;kFAAuD;;;;;;kFACvE,6LAAC;wEAAK,WAAW,CAAC,kBAAkB,EAAE,MAAM,cAAc,IAAI,MAAM,oBAAoB,GAAG,IAAI,mCAAmC,iCAAiC;kFAChK,MAAM,cAAc,GAAG,MAAM,MAAM,oBAAoB;;;;;;;;;;;;;;;;;;kEAM9D,6LAAC;wDAAI,WAAU;;0EACb,6LAAC;gEAAG,WAAU;0EAA8E;;;;;;4DAC3F,MAAM,cAAc,IAAI,MAAM,cAAc,CAAC,MAAM,GAAG,kBACrD,6LAAC;gEAAI,WAAU;0EACZ,MAAM,cAAc,CAAC,GAAG,CAAC,CAAC,uBACzB,6LAAC;wEAAoB,WAAU;;0FAC7B,6LAAC;;kGACC,6LAAC;wFAAE,WAAW,CAAC,+DAA+D,EAAE,OAAO,MAAM,KAAK,WAAW,iBAAiB,IAAI;;4FAC/H,OAAO,YAAY,IAAI;4FAEvB,eAAe,OAAO,aAAa;;;;;;;kGAGtC,6LAAC;kGAAG,sBAAsB;;;;;;;;;;;;0FAE5B,6LAAC;gFAAK,WAAU;0FAA4C,cAAc,OAAO,UAAU;;;;;;;uEAVnF,OAAO,EAAE;;;;;;;;;qFAevB,6LAAC;gEAAE,WAAU;0EAAkD;;;;;;;;;;;;kEAKnE,6LAAC;wDAAI,WAAU;;0EACb,6LAAC;gEAAG,WAAU;0EAA8E;;;;;;0EAC5F,6LAAC;gEAAI,WAAU;;kFACb,6LAAC,0KAAI;wEAAC,MAAM,CAAC,SAAS,EAAE,MAAM,EAAE,EAAE;wEAAE,WAAU;kFAAyO;;;;;;kFAGvR,6LAAC,0KAAI;wEAAC,MAAM,CAAC,QAAQ,EAAE,MAAM,EAAE,EAAE;wEAAE,WAAU;kFAAyO;;;;;;oEAGrR,iCACC,6LAAC,0KAAI;wEAAC,MAAM,CAAC,SAAS,EAAE,MAAM,EAAE,EAAE;wEAAE,WAAU;kFAAkQ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;uCA3DnT,GAAG,MAAM,EAAE,CAAC,SAAS,CAAC;;;;;;+BAvBd,MAAM,EAAE;;;;;;;;;;;;;;;;;;;;;;AAmGzC;GA1SwB;KAAA","debugId":null}},
    {"offset": {"line": 814, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/ckhme/my-workflow-app/app/profile/constants.ts"],"sourcesContent":["export const CADET_RANKS = [\r\n  'c/PVT', 'c/PV2', 'c/PFC', 'c/CPL', 'c/SGT', 'c/SSG', 'c/SFC', 'c/MSG', 'c/1SG', 'c/SGM', 'c/CSM', \r\n  'c/2LT', 'c/1LT', 'c/CPT', 'c/MAJ', 'c/LTC', 'c/COL'\r\n];\r\n\r\nexport const FALL_SPORTS = [\r\n  'None', 'JV Football','Varsity Football', 'JV Soccer', 'Varsity Soccer', 'Cross Country', 'Swimming (Off Season)', 'PG Lacross', 'PG Basketball', 'PG Football', 'PT'\r\n];\r\n\r\nexport const WINTER_SPORTS = [\r\n  'None', 'JV Basketball', 'Varsity Basketball', 'Wrestling', 'Swimming', 'Indoor Track', 'PG Lacrosse', 'PG Basketball', 'PT' \r\n];\r\n\r\nexport const SPRING_SPORTS = [\r\n  'None', 'Baseball', 'Varsity Lacrosse', 'Track & Field', 'Tennis', 'Golf', 'PG Basketball', 'PG Lacrosse', \r\n];\r\n\r\nexport const CONDUCT_STATUSES = [\r\n  'Exemplary',\r\n  'Commendable',\r\n  'Satisfactory',\r\n  'Deficient',\r\n  'Unsatisfactory'\r\n];\r\n\r\nexport const PROBATION_STATUSES = [\r\n  'None',\r\n  'Academic',\r\n  'Disciplinary',\r\n  'Honor',\r\n  'Physical'\r\n];\r\n\r\nexport const GRADE_LEVELS = [\r\n  '7th', '8th', '9th', '10th', '11th', '12th', 'PG'\r\n];\r\n\r\n// Roles authorized to EDIT profiles\r\nexport const EDIT_AUTHORIZED_ROLES = [\r\n  'S1', \r\n  'Command Sergeant Major', \r\n  'TAC Officer', \r\n  'Deputy Commandant', \r\n  'Commandant', \r\n  'Admin'\r\n];\r\n\r\n// Roles authorized to manage Star Tours\r\nexport const STAR_TOUR_AUTHORIZED_ROLES = [\r\n  'Commandant', \r\n  'Deputy Commandant', \r\n  'Admin'\r\n];"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;AAAO,MAAM,cAAc;IACzB;IAAS;IAAS;IAAS;IAAS;IAAS;IAAS;IAAS;IAAS;IAAS;IAAS;IAC1F;IAAS;IAAS;IAAS;IAAS;IAAS;CAC9C;AAEM,MAAM,cAAc;IACzB;IAAQ;IAAc;IAAoB;IAAa;IAAkB;IAAiB;IAAyB;IAAc;IAAiB;IAAe;CAClK;AAEM,MAAM,gBAAgB;IAC3B;IAAQ;IAAiB;IAAsB;IAAa;IAAY;IAAgB;IAAe;IAAiB;CACzH;AAEM,MAAM,gBAAgB;IAC3B;IAAQ;IAAY;IAAoB;IAAiB;IAAU;IAAQ;IAAiB;CAC7F;AAEM,MAAM,mBAAmB;IAC9B;IACA;IACA;IACA;IACA;CACD;AAEM,MAAM,qBAAqB;IAChC;IACA;IACA;IACA;IACA;CACD;AAEM,MAAM,eAAe;IAC1B;IAAO;IAAO;IAAO;IAAQ;IAAQ;IAAQ;CAC9C;AAGM,MAAM,wBAAwB;IACnC;IACA;IACA;IACA;IACA;IACA;CACD;AAGM,MAAM,6BAA6B;IACxC;IACA;IACA;CACD","debugId":null}},
    {"offset": {"line": 930, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/ckhme/my-workflow-app/app/manage/page.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { createClient } from '@/utils/supabase/client'\r\nimport { useState, useEffect, useMemo } from 'react'\r\nimport Link from 'next/link'\r\nimport RosterClient from './RosterClient' \r\nimport { RosterCadet } from './RosterClient' \r\nimport { EDIT_AUTHORIZED_ROLES } from '@/app/profile/constants' \r\n\r\n// --- Data Types (Original) ---\r\ntype Company = { id: string; company_name: string }\r\ntype Group = { id: string, group_name: string }\r\ntype SimpleRole = { id: string; role_name: string; default_role_level: number }\r\ntype Role = {\r\n  role_id: string;\r\n  role_name: string;\r\n  company_id: string | null;\r\n  company_name: string | null;\r\n  approval_group_id: string | null;\r\n  approval_group_name: string | null;\r\n  default_role_level: number;\r\n  can_manage_own_company_roster: boolean;\r\n  can_manage_all_rosters: boolean;\r\n}\r\ntype RosterUser = {\r\n  user_id: string;\r\n  first_name: string;\r\n  last_name: string;\r\n  role_id: string | null;\r\n  role_name: string | null;\r\n  role_level: number;\r\n}\r\ntype UnassignedUser = {\r\n  user_id: string;\r\n  first_name: string;\r\n  last_name: string;\r\n}\r\ntype SearchUser = {\r\n  user_id: string;\r\n  first_name: string;\r\n  last_name: string;\r\n  role_name: string | null;\r\n  company_name: string | null;\r\n  role_level: number;\r\n}\r\n// --- End Original Types ---\r\n\r\nexport default function ManagePage() {\r\n  const supabase = createClient()\r\n  \r\n  const [activeTab, setActiveTab] = useState<'roster' | 'unassigned' | 'roles'>('roster')\r\n  const [loading, setLoading] = useState(true)\r\n  const [error, setError] = useState<string | null>(null)\r\n\r\n  const [roles, setRoles] = useState<Role[]>([])\r\n  const [companies, setCompanies] = useState<Company[]>([]) // <-- Used for filter\r\n  const [groups, setGroups] = useState<Group[]>([])\r\n  const [roster, setRoster] = useState<RosterUser[]>([]) \r\n  const [unassigned, setUnassigned] = useState<UnassignedUser[]>([]) \r\n  const [searchTerm, setSearchTerm] = useState('')\r\n\r\n  const [rosterData, setRosterData] = useState<RosterCadet[]>([])\r\n  \r\n  const [canEditProfiles, setCanEditProfiles] = useState(false)\r\n  const [viewerRoleLevel, setViewerRoleLevel] = useState(0) \r\n  const [showCreateRoleForm, setShowCreateRoleForm] = useState(false)\r\n\r\n\r\n  useEffect(() => {\r\n    async function getInitialData() {\r\n      setLoading(true)\r\n      setError(null)\r\n\r\n      const { data: { user } } = await supabase.auth.getUser()\r\n      if (!user) {\r\n        setLoading(false)\r\n        setError(\"You must be logged in.\")\r\n        return\r\n      }\r\n\r\n      const { data: viewerProfile } = await supabase\r\n        .from('profiles')\r\n        .select('role:role_id (role_name, default_role_level)')\r\n        .eq('id', user.id)\r\n        .single()\r\n      \r\n      const roleName = (viewerProfile?.role as any)?.role_name || ''\r\n      const roleLevel = (viewerProfile?.role as any)?.default_role_level || 0\r\n      const isAdmin = roleName === 'Admin'\r\n      \r\n      setCanEditProfiles(EDIT_AUTHORIZED_ROLES.includes(roleName) || roleName.includes('TAC') || isAdmin)\r\n      setViewerRoleLevel(roleLevel)\r\n\r\n      const [\r\n        rolesRes, \r\n        companiesRes, \r\n        groupsRes, \r\n        rosterRes, \r\n        unassignedRes,\r\n        fullRosterRes \r\n      ] = await Promise.all([\r\n        supabase.rpc('get_all_roles_with_details'),\r\n        supabase.from('companies').select('*').order('company_name'), // <-- Fetches companies\r\n        supabase.from('approval_groups').select('*'),\r\n        supabase.rpc('get_roster_with_roles'),\r\n        supabase.rpc('get_unassigned_users'), \r\n        supabase.rpc('get_full_roster') \r\n      ])\r\n      \r\n      if (rolesRes.data) setRoles(rolesRes.data)\r\n      if (companiesRes.data) setCompanies(companiesRes.data) // <-- Set companies state\r\n      if (groupsRes.data) setGroups(groupsRes.data)\r\n      if (rosterRes.data) setRoster(rosterRes.data)\r\n      \r\n      if (fullRosterRes.error) {\r\n        console.error(\"Error fetching full roster:\", fullRosterRes.error.message)\r\n        setError(fullRosterRes.error.message)\r\n      } else {\r\n        setRosterData(fullRosterRes.data as RosterCadet[])\r\n      }\r\n\r\n      if (unassignedRes.error) {\r\n         console.error(\"Error fetching unassigned users:\", unassignedRes.error.message)\r\n         if (!error) setError(unassignedRes.error.message)\r\n      } else {\r\n        setUnassigned(unassignedRes.data as UnassignedUser[])\r\n      }\r\n\r\n      setLoading(false)\r\n    }\r\n\r\n    getInitialData()\r\n  }, [supabase])\r\n\r\n  const searchResults = useMemo(() => {\r\n    if (!searchTerm) return []\r\n    const lowerSearch = searchTerm.toLowerCase()\r\n    return roster.filter(u => \r\n      u.first_name.toLowerCase().includes(lowerSearch) || \r\n      u.last_name.toLowerCase().includes(lowerSearch)\r\n    ).map(u => ({\r\n      user_id: u.user_id,\r\n      first_name: u.first_name,\r\n      last_name: u.last_name,\r\n      role_name: u.role_name,\r\n      role_level: u.role_level,\r\n      company_name: roles.find(r => r.role_id === u.role_id)?.company_name || null\r\n    } as SearchUser))\r\n  }, [searchTerm, roster, roles])\r\n\r\n  const handleRoleCreated = (newRole: Role) => {\r\n    setRoles(prevRoles => [...prevRoles, newRole].sort((a, b) => a.default_role_level - b.default_role_level))\r\n    setShowCreateRoleForm(false)\r\n  }\r\n\r\n  // --- NEW: Print Function ---\r\n  const handlePrintRoster = () => {\r\n    window.print()\r\n  }\r\n\r\n  if (loading) {\r\n    return <div className=\"max-w-7xl mx-auto p-4 sm:p-6 lg:p-8 text-center text-gray-600 dark:text-gray-400\">Loading management data...</div>\r\n  }\r\n\r\n  return (\r\n    <>\r\n      {/* --- NEW: Print Styles --- */}\r\n      <style jsx global>{`\r\n        @media print {\r\n          body {\r\n            background-color: white !important;\r\n            color: black !important;\r\n          }\r\n          /* Hide everything */\r\n          header, \r\n          .no-print,\r\n          div[aria-label=\"Tabs\"] {\r\n            display: none !important;\r\n          }\r\n          /* Show only the printable area */\r\n          #printable-roster {\r\n            display: block !important;\r\n            visibility: visible !important;\r\n            box-shadow: none !important;\r\n            border: none !important;\r\n          }\r\n          /* Ensure main layout containers don't hide it */\r\n          body > div, body > main {\r\n            display: block !important;\r\n            visibility: visible !important;\r\n          }\r\n          .printable-table {\r\n            width: 100%;\r\n            border-collapse: collapse;\r\n          }\r\n          .printable-table th, .printable-table td {\r\n            border: 1px solid #ccc;\r\n            padding: 4px 8px;\r\n            font-size: 10pt;\r\n          }\r\n          .printable-table th {\r\n            background-color: #f4f4f4;\r\n            font-weight: 600;\r\n          }\r\n          /* Hide details in print */\r\n          .print-hide {\r\n            display: none !important;\r\n          }\r\n        }\r\n      `}</style>\r\n    \r\n      <div className=\"max-w-7xl mx-auto p-4 sm:p-6 lg:p-8\">\r\n        <h1 className=\"text-3xl font-bold text-gray-900 dark:text-white mb-6\">\r\n          Management\r\n        </h1>\r\n        \r\n        {/* --- TABS --- */}\r\n        <div className=\"mb-6 border-b border-gray-200 dark:border-gray-700 no-print\">\r\n          <nav className=\"-mb-px flex space-x-8\" aria-label=\"Tabs\">\r\n            <button\r\n              onClick={() => setActiveTab('roster')}\r\n              className={`whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm ${\r\n                activeTab === 'roster'\r\n                  ? 'border-indigo-500 text-indigo-600 dark:text-indigo-400'\r\n                  : 'border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-600'\r\n              }`}\r\n            >\r\n              Cadet Roster\r\n            </button>\r\n            <button\r\n              onClick={() => setActiveTab('unassigned')}\r\n              className={`whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm ${\r\n                activeTab === 'unassigned'\r\n                  ? 'border-indigo-500 text-indigo-600 dark:text-indigo-400'\r\n                  : 'border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-600'\r\n              }`}\r\n            >\r\n              Unassigned Cadets <span className=\"ml-1.5 inline-block py-0.5 px-2 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200\">{unassigned.length}</span>\r\n            </button>\r\n            <button\r\n              onClick={() => setActiveTab('roles')}\r\n              className={`whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm ${\r\n                activeTab === 'roles'\r\n                  ? 'border-indigo-500 text-indigo-600 dark:text-indigo-400'\r\n                  : 'border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-600'\r\n              }`}\r\n            >\r\n              Role Management\r\n            </button>\r\n          </nav>\r\n        </div>\r\n        \r\n        {error && (\r\n          <div className=\"p-4 text-center text-red-600 dark:text-red-400 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg\">\r\n            <p className=\"font-medium\">Error loading data:</p>\r\n            <p className=\"text-sm\">{error}</p>\r\n          </div>\r\n        )}\r\n\r\n        {/* --- TAB CONTENT: Cadet Roster --- */}\r\n        <div id=\"printable-roster\" className={activeTab === 'roster' ? '' : 'hidden'}>\r\n          <div className=\"flex justify-between items-center mb-4 no-print\">\r\n            <h2 className=\"text-xl font-semibold text-gray-900 dark:text-white\">Cadet Roster</h2>\r\n            <button\r\n              onClick={handlePrintRoster}\r\n              className=\"px-4 py-2 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-200 text-sm font-medium rounded-md shadow-sm hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors\"\r\n            >\r\n              Print Roster\r\n            </button>\r\n          </div>\r\n          {/* Pass companies for filter dropdown */}\r\n          <RosterClient \r\n            initialData={rosterData} \r\n            canEditProfiles={canEditProfiles} \r\n            companies={companies}\r\n          />\r\n        </div>\r\n\r\n        {/* --- TAB CONTENT: Unassigned Cadets --- */}\r\n        <div className={`no-print ${activeTab === 'unassigned' ? '' : 'hidden'}`}>\r\n          <div className=\"bg-white dark:bg-gray-800 shadow-sm border border-gray-200 dark:border-gray-700 rounded-lg\">\r\n            <div className=\"p-4 border-b border-gray-200 dark:border-gray-700\">\r\n              <h2 className=\"text-xl font-semibold text-gray-900 dark:text-white\">Unassigned Cadets ({unassigned.length})</h2>\r\n              <p className=\"text-sm text-gray-600 dark:text-gray-400 mt-1\">These users have profiles but no assigned role. Assign them a role to add them to the main roster.</p>\r\n            </div>\r\n            <ul className=\"divide-y divide-gray-200 dark:divide-gray-700\">\r\n              {unassigned.length > 0 ? unassigned.map(u => (\r\n                <li key={u.user_id} className=\"p-4 flex justify-between items-center\">\r\n                  <span className=\"font-medium text-gray-900 dark:text-white\">{u.last_name}, {u.first_name}</span>\r\n                  <Link href={`/profile/${u.user_id}`} className=\"text-sm font-medium text-indigo-600 hover:text-indigo-900 dark:text-indigo-400 dark:hover:text-indigo-200\">\r\n                    Assign Role &rarr;\r\n                  </Link>\r\n                </li>\r\n              )) : (\r\n                <li className=\"p-4 text-center text-gray-500 dark:text-gray-400\">All cadets are assigned roles.</li>\r\n              )}\r\n            </ul>\r\n          </div>\r\n        </div>\r\n\r\n        {/* --- TAB CONTENT: Role Management --- */}\r\n        <div className={`no-print ${activeTab === 'roles' ? '' : 'hidden'}`}>\r\n          <SearchBar searchTerm={searchTerm} setSearchTerm={setSearchTerm} searchResults={searchResults} />\r\n\r\n          {viewerRoleLevel >= 90 && (\r\n            <div className=\"my-6\">\r\n              {showCreateRoleForm ? (\r\n                <CreateRoleForm \r\n                  companies={companies} \r\n                  groups={groups}\r\n                  onCancel={() => setShowCreateRoleForm(false)}\r\n                  onSuccess={handleRoleCreated}\r\n                />\r\n              ) : (\r\n                <button\r\n                  onClick={() => setShowCreateRoleForm(true)}\r\n                  className=\"w-full py-2 px-4 bg-indigo-600 text-white font-medium rounded-md shadow-sm hover:bg-indigo-700 transition-colors\"\r\n                >\r\n                  + Create New Role\r\n                </button>\r\n              )}\r\n            </div>\r\n          )}\r\n          \r\n          <div className=\"mt-8 flow-root\">\r\n            <div className=\"-mx-4 -my-2 overflow-x-auto sm:-mx-6 lg:-mx-8\">\r\n              <div className=\"inline-block min-w-full py-2 align-middle sm:px-6 lg:px-8\">\r\n                <div className=\"overflow-hidden shadow ring-1 ring-black ring-opacity-5 dark:ring-white dark:ring-opacity-10 sm:rounded-lg\">\r\n                  <table className=\"min-w-full divide-y divide-gray-300 dark:divide-gray-700\">\r\n                    <thead className=\"bg-gray-50 dark:bg-gray-800\">\r\n                      <tr>\r\n                        <th className=\"py-3.5 pl-4 pr-3 text-left text-sm font-semibold text-gray-900 dark:text-white sm:pl-6\">Role Name</th>\r\n                        <th className=\"px-3 py-3.5 text-left text-sm font-semibold text-gray-900 dark:text-white\">Company</th>\r\n                        <th className=\"px-3 py-3.5 text-left text-sm font-semibold text-gray-900 dark:text-white\">Group</th>\r\n                        <th className=\"px-3 py-3.5 text-left text-sm font-semibold text-gray-900 dark:text-white\">Level</th>\r\n                        <th className=\"relative py-3.5 pl-3 pr-4 sm:pr-6\"><span className=\"sr-only\">Actions</span></th>\r\n                      </tr>\r\n                    </thead>\r\n                    <tbody className=\"divide-y divide-gray-200 dark:divide-gray-700 bg-white dark:bg-gray-800\">\r\n                      {roles.map(role => (\r\n                        <tr key={role.role_id}>\r\n                          <td className=\"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-gray-900 dark:text-white sm:pl-6\">{role.role_name}</td>\r\n                          <td className=\"whitespace-nowrap px-3 py-4 text-sm text-gray-500 dark:text-gray-400\">{role.company_name || 'N/A'}</td>\r\n                          <td className=\"whitespace-nowrap px-3 py-4 text-sm text-gray-500 dark:text-gray-400\">{role.approval_group_name || 'N/A'}</td>\r\n                          <td className=\"whitespace-nowrap px-3 py-4 text-sm text-gray-500 dark:text-gray-400\">{role.default_role_level}</td>\r\n                          <td className=\"relative whitespace-nowrap py-4 pl-3 pr-4 text-right text-sm font-medium sm:pr-6\">\r\n                            <Link href=\"#\" className=\"text-indigo-600 hover:text-indigo-900 dark:text-indigo-400 dark:hover:text-indigo-200\">Edit</Link>\r\n                          </td>\r\n                        </tr>\r\n                      ))}\r\n                    </tbody>\r\n                  </table>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </>\r\n  )\r\n}\r\n\r\n\r\n// --- Search Bar Component (Original) ---\r\nfunction SearchBar({ searchTerm, setSearchTerm, searchResults }: { searchTerm: string, setSearchTerm: (term: string) => void, searchResults: SearchUser[] }) {\r\n  // ... (This component is unchanged from your original) ...\r\n  return (\r\n    <div className=\"relative no-print\">\r\n      <input\r\n        type=\"text\"\r\n        value={searchTerm}\r\n        onChange={(e) => setSearchTerm(e.target.value)}\r\n        placeholder=\"Find a user (for Role Management)...\"\r\n        className=\"w-full p-2 border border-gray-300 dark:border-gray-700 rounded-md dark:bg-gray-800 dark:text-white\"\r\n      />\r\n      {searchTerm && (\r\n        <div className=\"absolute z-10 w-full mt-1 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-700 rounded-md shadow-lg max-h-60 overflow-y-auto\">\r\n          {searchResults.length > 0 ? (\r\n            searchResults.map(user => (\r\n              <Link key={user.user_id} href={`/profile/${user.user_id}`} className=\"block px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700\">\r\n                {user.last_name}, {user.first_name} ({user.role_name || 'Unassigned'}) - {user.company_name || 'N/A'}\r\n              </Link>\r\n            ))\r\n          ) : (\r\n            <div className=\"px-4 py-2 text-sm text-gray-500\">No users found.</div>\r\n          )}\r\n        </div>\r\n      )}\r\n    </div>\r\n  )\r\n}\r\n\r\n// --- Create Role Form Component (Original) ---\r\nfunction CreateRoleForm({ companies, groups, onCancel, onSuccess }: { companies: Company[], groups: Group[], onCancel: () => void, onSuccess: (newRole: Role) => void }) {\r\n  // ... (This component is unchanged) ...\r\n  const supabase = createClient()\r\n  const [formData, setFormData] = useState({\r\n    role_name: '',\r\n    company_id: '',\r\n    approval_group_id: '',\r\n    default_role_level: 10,\r\n    can_manage_all_rosters: false,\r\n    can_manage_own_company_roster: false\r\n  })\r\n  const [isSaving, setIsSaving] = useState(false)\r\n  const [error, setError] = useState<string | null>(null)\r\n\r\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLSelectElement>) => {\r\n    const { name, value, type } = e.target\r\n    if (type === 'checkbox') {\r\n      const { checked } = e.target as HTMLInputElement\r\n      setFormData(prev => ({ ...prev, [name]: checked }))\r\n    } else {\r\n      setFormData(prev => ({ ...prev, [name]: value }))\r\n    }\r\n  }\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault()\r\n    setIsSaving(true)\r\n    setError(null)\r\n\r\n    const { error: rpcError } = await supabase.rpc('create_new_role', {\r\n      p_role_name: formData.role_name,\r\n      p_company_id: formData.company_id || null,\r\n      p_approval_group_id: formData.approval_group_id || null,\r\n      p_default_role_level: Number(formData.default_role_level),\r\n      p_can_manage_all_rosters: formData.can_manage_all_rosters,\r\n      p_can_manage_own_company_roster: formData.can_manage_own_company_roster\r\n    })\r\n\r\n    setIsSaving(false)\r\n    if (rpcError) {\r\n      setError(rpcError.message)\r\n    } else {\r\n      const newRole: Role = {\r\n        role_id: '', \r\n        role_name: formData.role_name,\r\n        company_id: formData.company_id || null,\r\n        company_name: companies.find(c => c.id === formData.company_id)?.company_name || null,\r\n        approval_group_id: formData.approval_group_id || null,\r\n        approval_group_name: groups.find(g => g.id === formData.approval_group_id)?.group_name || null,\r\n        default_role_level: Number(formData.default_role_level),\r\n        can_manage_all_rosters: formData.can_manage_all_rosters,\r\n        can_manage_own_company_roster: formData.can_manage_own_company_roster\r\n      }\r\n      onSuccess(newRole)\r\n    }\r\n  }\r\n\r\n  return (\r\n    <form onSubmit={handleSubmit} className=\"p-6 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-sm\">\r\n      <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">Create New Role</h3>\r\n      <div className=\"mt-4 grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n        <div>\r\n          <label className=\"block text-sm font-bold text-gray-700 dark:text-gray-300\">Role Name</label>\r\n          <input\r\n            type=\"text\"\r\n            name=\"role_name\"\r\n            value={formData.role_name}\r\n            onChange={handleChange}\r\n            required\r\n            className=\"mt-1 block w-full rounded-md border-gray-300 dark:bg-gray-700 dark:border-gray-600 shadow-sm p-2\"\r\n          />\r\n        </div>\r\n        <div>\r\n          <label className=\"block text-sm font-bold text-gray-700 dark:text-gray-300\">Role Level (0-100)</label>\r\n          <input\r\n            type=\"number\"\r\n            name=\"default_role_level\"\r\n            value={formData.default_role_level}\r\n            onChange={handleChange}\r\n            required\r\n            min=\"0\"\r\n            max=\"100\"\r\n            className=\"mt-1 block w-full rounded-md border-gray-300 dark:bg-gray-700 dark:border-gray-600 shadow-sm p-2\"\r\n          />\r\n        </div>\r\n        <div>\r\n          <label className=\"block text-sm font-bold text-gray-700 dark:text-gray-300\">Company (Optional)</label>\r\n          <select\r\n            name=\"company_id\"\r\n            value={formData.company_id}\r\n            onChange={handleChange}\r\n            className=\"mt-1 block w-full rounded-md border-gray-300 dark:bg-gray-700 dark:border-gray-600 shadow-sm p-2\"\r\n          >\r\n            <option value=\"\">None</option>\r\n            {companies.map(c => <option key={c.id} value={c.id}>{c.company_name}</option>)}\r\n          </select>\r\n        </div>\r\n        <div>\r\n          <label className=\"block text-sm font-bold text-gray-700 dark:text-gray-300\">Approval Group (Optional)</label>\r\n          <select\r\n            name=\"approval_group_id\"\r\n            value={formData.approval_group_id}\r\n            onChange={handleChange}\r\n            className=\"mt-1 block w-full rounded-md border-gray-300 dark:bg-gray-700 dark:border-gray-600 shadow-sm p-2\"\r\n          >\r\n            <option value=\"\">None</option>\r\n            {groups.map(g => <option key={g.id} value={g.id}>{g.group_name}</option>)}\r\n          </select>\r\n        </div>\r\n        <div className=\"col-span-full space-y-2\">\r\n          <div className=\"flex items-center\">\r\n            <input\r\n              type=\"checkbox\"\r\n              name=\"can_manage_all_rosters\"\r\n              checked={formData.can_manage_all_rosters}\r\n              onChange={handleChange}\r\n              className=\"h-4 w-4 rounded text-indigo-600\"\r\n            />\r\n            <label className=\"ml-2 block text-sm text-gray-900 dark:text-gray-300\">Can Manage All Rosters</label>\r\n          </div>\r\n          <div className=\"flex items-center\">\r\n            <input\r\n              type=\"checkbox\"\r\n              name=\"can_manage_own_company_roster\"\r\n              checked={formData.can_manage_own_company_roster}\r\n              onChange={handleChange}\r\n              className=\"h-4 w-4 rounded text-indigo-600\"\r\n            />\r\n            <label className=\"ml-2 block text-sm text-gray-900 dark:text-gray-300\">Can Manage Own Company Roster</label>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      {error && <p className=\"mt-2 text-sm text-red-600\">{error}</p>}\r\n      <div className=\"mt-6 flex justify-end gap-3\">\r\n        <button\r\n          type=\"button\"\r\n          onClick={onCancel}\r\n          className=\"py-2 px-4 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-200 text-sm font-medium rounded-md shadow-sm hover:bg-gray-50 dark:hover:bg-gray-600\"\r\n        >\r\n          Cancel\r\n        </button>\r\n        <button\r\n          type=\"submit\"\r\n          disabled={isSaving}\r\n          className=\"py-2 px-4 bg-indigo-600 text-white text-sm font-medium rounded-md shadow-sm hover:bg-indigo-700 disabled:opacity-50\"\r\n        >\r\n          {isSaving ? 'Creating...' : 'Create Role'}\r\n        </button>\r\n      </div>\r\n    </form>\r\n  )\r\n}"],"names":[],"mappings":"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","debugId":null}}]
}
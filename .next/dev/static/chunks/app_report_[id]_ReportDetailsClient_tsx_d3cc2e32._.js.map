{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/ckhme/my-workflow-app/app/report/%5Bid%5D/ReportDetailsClient.tsx"],"sourcesContent":["// in app/report/[id]/ReportDetailsClient.tsx\r\n'use client' \r\n\r\n// All imports from your original file\r\nimport { createClient } from '@/utils/supabase/client'\r\nimport { useRouter } from 'next/navigation'\r\nimport { useState, useEffect, useMemo } from 'react'\r\nimport { User } from '@supabase/supabase-js'\r\nimport React from 'react' \r\n\r\n// --- Types ---\r\n// (You can move these to a shared types file if you want)\r\ntype Report = {\r\n  id: string;\r\n  status: string;\r\n  notes: string | null;\r\n  submitted_by: string;\r\n  subject_cadet_id: string;\r\n  current_approver_group_id: string | null; \r\n  date_of_offense: string;\r\n  offense_type_id: string;\r\n  demerits_effective: number;\r\n  subject: { first_name: string, last_name: string }; \r\n  submitter: { first_name: string, last_name: string };\r\n  offense_type: {\r\n    offense_name: string;\r\n    offense_code: string;\r\n    demerits: number;\r\n    policy_category: number;\r\n  }\r\n};\r\n\r\ntype Log = {\r\n  id: string;\r\n  action: string;\r\n  comment: string;\r\n  created_at: string;\r\n  actor: { first_name: string, last_name: string } | null; \r\n};\r\n\r\ntype OffenseType = {\r\n  id: string;\r\n  offense_group: string;\r\n  offense_name: string;\r\n  demerits: number;\r\n}\r\n\r\ntype Appeal = {\r\n  id: string;\r\n  status: string;\r\n  justification: string;\r\n  current_assignee_id: string | null;\r\n  current_group_id: string | null;\r\n  issuer_comment: string | null;\r\n  chain_comment: string | null;\r\n  final_comment: string | null;\r\n}\r\n\r\n// --- Props Interface ---\r\ninterface ReportDetailsClientProps {\r\n  user: User;\r\n  initialReport: Report;\r\n  initialLogs: Log[];\r\n  initialAppeal: Appeal | null;\r\n  offenses: OffenseType[];\r\n  escalationTarget: string | null;\r\n  permissions: {\r\n    isSubmitter: boolean;\r\n    isSubject: boolean;\r\n    isApprover: boolean;\r\n    canActOnAppeal: boolean;\r\n  }\r\n}\r\n\r\n/**\r\n * This component now holds all the state and interactivity.\r\n * It receives its initial data as props from the server.\r\n */\r\nexport default function ReportDetailsClient({\r\n  user,\r\n  initialReport,\r\n  initialLogs,\r\n  initialAppeal,\r\n  offenses,\r\n  escalationTarget: initialEscalationTarget,\r\n  permissions\r\n}: ReportDetailsClientProps) {\r\n  \r\n  const supabase = createClient()\r\n  const router = useRouter()\r\n\r\n  // --- STATE HOOKS ---\r\n  // Initialize state from props\r\n  const [report, setReport] = useState<Report>(initialReport)\r\n  const [logs, setLogs] = useState<Log[]>(initialLogs)\r\n  const [appeal, setAppeal] = useState<Appeal | null>(initialAppeal)\r\n  \r\n  const [isActionLoading, setActionLoading] = useState(false)\r\n  \r\n  // Permissions are now just props\r\n  const { isSubmitter, isSubject, isApprover, canActOnAppeal } = permissions\r\n  \r\n  // Form Modes & Inputs\r\n  const [isEditing, setIsEditing] = useState(false);\r\n  const [editableOffenseId, setEditableOffenseId] = useState(initialReport.offense_type_id);\r\n  const [editableNotes, setEditableNotes] = useState(initialReport.notes || '');\r\n  const [editableDate, setEditableDate] = useState('');\r\n  const [editableTime, setEditableTime] = useState('');\r\n  \r\n  const [isAppealing, setIsAppealing] = useState(false);\r\n  const [isEscalating, setIsEscalating] = useState(false);\r\n  const [appealJustification, setAppealJustification] = useState('');\r\n  const [comment, setComment] = useState('') \r\n  const [appealComment, setAppealComment] = useState('');\r\n  const [escalationTarget, setEscalationTarget] = useState(initialEscalationTarget || '');\r\n\r\n  // --- Data fetching is GONE from useEffect ---\r\n  // The server component handles all initial data loading.\r\n  // We only use useEffect if we need to react to prop changes,\r\n  // or set complex initial state.\r\n\r\n  useEffect(() => {\r\n    // Set initial appeal comment if needed\r\n    if (initialAppeal && initialAppeal.status === 'pending_commandant') {\r\n      setAppealComment(initialAppeal.chain_comment || initialAppeal.issuer_comment || '');\r\n    }\r\n  }, [initialAppeal])\r\n\r\n\r\n  // --- Helpers ---\r\n  // (All your helper functions remain unchanged)\r\n  const formatName = (person: { first_name: string, last_name: string } | null) => {\r\n    if (!person) return 'N/A';\r\n    return `${person.last_name}, ${person.first_name.charAt(0)}.`;\r\n  }\r\n  const formatStatus = (status: string) => {\r\n    switch (status) {\r\n      case 'completed': return 'Approved'; case 'rejected': return 'Rejected';\r\n      case 'needs_revision': return 'Revision Requested'; case 'pending_approval': return 'Pending Approval';\r\n      default: return status.replace('_', ' ');\r\n    }\r\n  }\r\n  const formatAppealStatus = (status: string) => {\r\n     switch (status) {\r\n       case 'pending_issuer': return 'Pending Initial Review';\r\n       case 'rejected_by_issuer': return 'Rejected by Issuer (Can Escalate)';\r\n       case 'pending_chain': return 'Pending Chain of Command';\r\n       case 'rejected_by_chain': return 'Rejected by Chain (Can Escalate)';\r\n       case 'pending_commandant': return 'Pending Commandant Review';\r\n       case 'approved': return 'Appeal Granted';\r\n       case 'rejected_final': return 'Appeal Denied (Final)';\r\n       default: return status.replace('_', ' ');\r\n     }\r\n  }\r\n\r\n  // --- Actions ---\r\n  // (All your action/handler functions remain unchanged)\r\n  async function handleApprovalAction(action: 'approve' | 'reject' | 'kickback') {\r\n    if (!report) return;\r\n    let rpcName = '';\r\n    if (action === 'approve') rpcName = 'handle_approval';\r\n    else if (action === 'reject') rpcName = 'handle_rejection';\r\n    else rpcName = 'handle_kickback';\r\n\r\n    if (!window.confirm(`Are you sure you want to ${action}?`)) return;\r\n    if ((action === 'reject' || action === 'kickback') && !comment) { alert(\"Comment required.\"); return; }\r\n\r\n    setActionLoading(true);\r\n    const payload = action === 'approve' ? { report_id_to_approve: report.id, approval_comment: comment || 'Approved' } : { p_report_id: report.id, p_comment: comment };\r\n    const { error } = await supabase.rpc(rpcName, payload);\r\n\r\n    if (error) { alert(error.message); setActionLoading(false); }\r\n    else { router.push('/'); router.refresh(); }\r\n  }\r\n\r\n  // Edit Report Handlers\r\n  function handleEditClick() {\r\n    if (!report) return;\r\n    setIsEditing(true);\r\n    setEditableOffenseId(report.offense_type_id);\r\n    setEditableNotes(report.notes || '');\r\n    \r\n    const dt = new Date(report.date_of_offense);\r\n    \r\n    const year = dt.getFullYear();\r\n    const month = String(dt.getMonth() + 1).padStart(2, '0');\r\n    const day = String(dt.getDate()).padStart(2, '0');\r\n    setEditableDate(`${year}-${month}-${day}`);\r\n    \r\n    setEditableTime(dt.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit', hour12: false }));\r\n  }\r\n\r\n  async function handleResubmit(e: React.FormEvent) {\r\n    e.preventDefault(); setActionLoading(true);\r\n    const localDateTime = new Date(`${editableDate}T${editableTime}:00`);\r\n    const fullTimestamp = localDateTime.toISOString();\r\n    const { error } = await supabase.rpc('resubmit_report', {\r\n      p_report_id: report.id, p_new_offense_type_id: editableOffenseId,\r\n      p_new_notes: editableNotes, p_new_timestamp: fullTimestamp\r\n    });\r\n    if (error) { alert(error.message); setActionLoading(false); }\r\n    else { router.push('/'); router.refresh(); }\r\n  }\r\n\r\n  // Appeal Handlers\r\n  async function handleSubmitAppeal(e: React.FormEvent) {\r\n      e.preventDefault();\r\n      if (!appealJustification.trim()) return;\r\n      setActionLoading(true);\r\n      const { error } = await supabase.from('appeals').insert({ report_id: report.id, appealing_cadet_id: user?.id, justification: appealJustification });\r\n      if (error) { alert(error.message); setActionLoading(false); }\r\n      else { \r\n        alert(\"Appeal submitted.\"); \r\n        // No need to refresh the router, just update state\r\n        setActionLoading(false);\r\n        setIsAppealing(false);\r\n        // We'll reload the page to get new appeal state from server\r\n        router.refresh();\r\n      }\r\n  }\r\n\r\n  async function handleAppealAction(action: 'grant' | 'reject') {\r\n      if (!appeal) return;\r\n      if (!appealComment.trim()) { alert(\"Please provide a comment.\"); return; }\r\n      setActionLoading(true);\r\n      let rpcName = '';\r\n      if (appeal.status === 'pending_issuer') rpcName = 'appeal_issuer_action';\r\n      else if (appeal.status === 'pending_chain') rpcName = 'appeal_chain_action';\r\n      else if (appeal.status === 'pending_commandant') rpcName = 'appeal_commandant_action';\r\n\r\n      if (rpcName) {\r\n          const { error } = await supabase.rpc(rpcName, { p_appeal_id: appeal.id, p_action: action, p_comment: appealComment });\r\n          if (error) alert(error.message);\r\n          else {\r\n              alert(action === 'grant' ? \"Appeal granted/forwarded.\" : \"Appeal rejected.\");\r\n              router.push('/');\r\n              router.refresh();\r\n          }\r\n      }\r\n      setActionLoading(false);\r\n  }\r\n\r\n  async function handleEscalate(e: React.FormEvent) {\r\n      e.preventDefault();\r\n      if (!appeal || !appealJustification.trim()) return;\r\n      setActionLoading(true);\r\n      const { error } = await supabase.rpc('escalate_appeal', {\r\n          p_appeal_id: appeal.id,\r\n          p_justification: appealJustification\r\n      });\r\n      if (error) { alert(error.message); setActionLoading(false); }\r\n      else {\r\n          alert(\"Appeal escalated.\");\r\n          setIsEscalating(false);\r\n          router.refresh();\r\n      }\r\n  }\r\n\r\n  // Group offenses for dropdown\r\n  const groupedOffenses = useMemo(() => {\r\n    return offenses.reduce((acc, o) => { (acc[o.offense_group] = acc[o.offense_group] || []).push(o); return acc; }, {} as Record<string, OffenseType[]>);\r\n  }, [offenses])\r\n  \r\n  // --- Render States ---\r\n  // (No 'loading' or 'error' states needed, server handles that)\r\n  if (!report) return null; // Server would have 404'd already\r\n\r\n  const showActionBox = isApprover && report.status === 'pending_approval' && !isEditing && !isAppealing;\r\n  const showRevisionBox = isSubmitter && report.status === 'needs_revision' && !isEditing;\r\n  const canAppeal = isSubject && report.status === 'completed' && !appeal && !isAppealing;\r\n  const canEscalate = isSubject && appeal && ['rejected_by_issuer', 'rejected_by_chain'].includes(appeal.status) && !isEscalating;\r\n\r\n  // --- RETURN JSX ---\r\n  // (This is your *exact* JSX from the original file, just copied over)\r\n  return (\r\n    <div className=\"max-w-4xl mx-auto p-4 sm:p-6 lg:p-8 space-y-6\">\r\n\r\n      {/* --- MODE 1: EDIT REPORT (Submitter) --- */}\r\n      {isEditing ? (\r\n        <div className=\"bg-white dark:bg-gray-800 p-6 rounded-lg shadow\">\r\n          <form onSubmit={handleResubmit} className=\"space-y-6\">\r\n            <h2 className=\"text-2xl font-bold text-gray-900 dark:text-white\">Edit Report</h2>\r\n             <div className=\"grid grid-cols-2 gap-4\">\r\n               <div>\r\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">Date</label>\r\n                <input type=\"date\" value={editableDate} onChange={e => setEditableDate(e.target.value)} required className=\"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-900 dark:text-white shadow-sm sm:text-sm\" />\r\n              </div>\r\n              <div>\r\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">Time</label>\r\n                <input type=\"time\" value={editableTime} onChange={e => setEditableTime(e.target.value)} required className=\"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-900 dark:text-white shadow-sm sm:text-sm\" />\r\n              </div>\r\n            </div>\r\n            <div>\r\n               <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">Offense</label>\r\n               <select value={editableOffenseId} onChange={e => setEditableOffenseId(e.target.value)} required className=\"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-900 dark:text-white shadow-sm sm:text-sm\">\r\n                 {Object.entries(groupedOffenses).map(([group, opts]) => (\r\n                   <optgroup label={group} key={group}>{opts.map(o => <option key={o.id} value={o.id}>({o.demerits}) {o.offense_name}</option>)}</optgroup>\r\n                 ))}\r\n               </select>\r\n            </div>\r\n            <div>\r\n               <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">Notes</label>\r\n               <textarea value={editableNotes} onChange={e => setEditableNotes(e.target.value)} rows={4} className=\"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-900 dark:text-white shadow-sm sm:text-sm\" />\r\n            </div>\r\n            <div className=\"flex gap-4\">\r\n              <button type=\"button\" onClick={() => setIsEditing(false)} disabled={isActionLoading} className=\"w-1/2 py-2 border border-gray-300 dark:border-gray-600 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700\">Cancel</button>\r\n              <button type=\"submit\" disabled={isActionLoading} className=\"w-1/2 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 disabled:bg-gray-400\">{isActionLoading ? 'Saving...' : 'Resubmit'}</button>\r\n            </div>\r\n          </form>\r\n        </div>\r\n      ) \r\n\r\n      /* --- MODE 2a: CREATE APPEAL (Subject) --- */\r\n      : isAppealing ? (\r\n         <div className=\"bg-white dark:bg-gray-800 p-6 rounded-lg shadow border-2 border-indigo-500\">\r\n             <form onSubmit={handleSubmitAppeal} className=\"space-y-6\">\r\n                 <h2 className=\"text-2xl font-bold text-gray-900 dark:text-white\">Appeal this Report</h2>\r\n                 <p className=\"text-sm text-gray-500 dark:text-gray-400\">\r\n                     State your case clearly. This will be sent first to <strong>{formatName(report.submitter)}</strong> for review.\r\n                 </p>\r\n                 <div>\r\n                     <label htmlFor=\"justification\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">Justification / Defense</label>\r\n                     <textarea id=\"justification\" rows={6} required value={appealJustification} onChange={(e) => setAppealJustification(e.target.value)} className=\"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-900 dark:text-white shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm\" placeholder=\"I respectfully appeal this report because...\" />\r\n                 </div>\r\n                 <div className=\"flex gap-4\">\r\n                     <button type=\"button\" onClick={() => setIsAppealing(false)} disabled={isActionLoading} className=\"w-1/2 py-2 border border-gray-300 dark:border-gray-600 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700\">Cancel</button>\r\n                     <button type=\"submit\" disabled={isActionLoading} className=\"w-1/2 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 disabled:bg-gray-400\">{isActionLoading ? 'Submitting...' : 'Submit Appeal'}</button>\r\n                 </div>\r\n             </form>\r\n         </div>\r\n      )\r\n\r\n      /* --- MODE 2b: ESCALATE APPEAL (Subject) --- */\r\n      : isEscalating && appeal ? (\r\n         <div className=\"bg-white dark:bg-gray-800 p-6 rounded-lg shadow border-2 border-yellow-500\">\r\n             <form onSubmit={handleEscalate} className=\"space-y-6\">\r\n                 <h2 className=\"text-2xl font-bold text-gray-900 dark:text-white\">Escalate Appeal</h2>\r\n                 <p className=\"text-sm text-gray-500 dark:text-gray-400\">\r\n                    You are escalating this appeal to the next level in the chain of command:\r\n                    <br />\r\n                    <strong className=\"text-lg text-gray-900 dark:text-white block mt-2\">\r\n                       {escalationTarget || 'Loading next step...'}\r\n                    </strong>\r\n                 </p>\r\n                 \r\n                 {appeal.issuer_comment && appeal.status === 'rejected_by_issuer' && (\r\n                    <div className=\"bg-red-50 dark:bg-red-900/20 p-3 rounded border-l-4 border-red-500\">\r\n                        <p className=\"text-sm font-medium text-red-800 dark:text-red-300\">Issuer's Reason for Rejection:</p>\r\n                        <p className=\"text-sm text-red-700 dark:text-red-200 italic\">\"{appeal.issuer_comment}\"</p>\r\n                    </div>\r\n                 )}\r\n                 {appeal.chain_comment && appeal.status === 'rejected_by_chain' && (\r\n                    <div className=\"bg-red-50 dark:bg-red-900/20 p-3 rounded border-l-4 border-red-500\">\r\n                        <p className=\"text-sm font-medium text-red-800 dark:text-red-300\">Chain of Command's Reason for Rejection:</p>\r\n                        <p className=\"text-sm text-red-700 dark:text-red-200 italic\">\"{appeal.chain_comment}\"</p>\r\n                    </div>\r\n                 )}\r\n\r\n                 <div>\r\n                     <label htmlFor=\"justification_esc\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">Update Justification (Optional)</label>\r\n                     <textarea id=\"justification_esc\" rows={6} required value={appealJustification} onChange={(e) => setAppealJustification(e.target.value)} className=\"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-900 dark:text-white shadow-sm sm:text-sm\" />\r\n                 </div>\r\n                 <div className=\"flex gap-4\">\r\n                     <button type=\"button\" onClick={() => setIsEscalating(false)} disabled={isActionLoading} className=\"w-1/2 py-2 border border-gray-300 dark:border-gray-600 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700\">Cancel</button>\r\n                     <button type=\"submit\" disabled={isActionLoading} className=\"w-1/2 py-2 bg-yellow-600 text-white rounded-md hover:bg-yellow-700 disabled:bg-gray-400\">{isActionLoading ? 'Escalating...' : 'Confirm Escalation'}</button>\r\n                 </div>\r\n             </form>\r\n         </div>\r\n      )\r\n\r\n      /* --- MODE 3: VIEW REPORT (Default) --- */\r\n      : (\r\n        <div className=\"bg-white dark:bg-gray-800 p-6 rounded-lg shadow\">\r\n          <div className=\"flex flex-col md:flex-row justify-between items-start md:items-center gap-4\">\r\n            <h1 className=\"text-2xl md:text-3xl font-bold text-gray-900 dark:text-white\">{report.offense_type.offense_name}</h1>\r\n            <span className={`px-3 py-1 rounded-full text-sm font-medium ${\r\n                report.status === 'completed' ? 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-100' :\r\n                report.status === 'rejected' ? 'bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-100' :\r\n                report.status === 'pending_approval' ? 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-100' :\r\n                'bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-100'\r\n            }`}>\r\n              {formatStatus(report.status)}\r\n            </span>\r\n          </div>\r\n\r\n          {/* --- APPEAL STATUS & HISTORY RECORD --- */}\r\n          {appeal && (\r\n              <div className=\"mt-6 space-y-4\">\r\n                  <div className=\"bg-indigo-50 dark:bg-indigo-900/30 border-l-4 border-indigo-500 p-4\">\r\n                      <div className=\"flex justify-between items-center\">\r\n                          <h3 className=\"text-lg font-medium text-indigo-800 dark:text-indigo-200\">Appeal Status</h3>\r\n                          <span className=\"text-sm font-bold text-indigo-900 dark:text-indigo-100 uppercase tracking-wider\">\r\n                              {formatAppealStatus(appeal.status)}\r\n                          </span>\r\n                      </div>\r\n                  </div>\r\n\r\n                  <div className=\"bg-gray-50 dark:bg-gray-900/50 p-4 rounded-lg border dark:border-gray-700 space-y-3\">\r\n                      <h4 className=\"font-medium text-gray-900 dark:text-white mb-2\">Appeal Record</h4>\r\n                      <div className=\"pl-4 border-l-2 border-gray-300 dark:border-gray-600\">\r\n                          <p className=\"text-xs uppercase font-semibold text-gray-500 dark:text-gray-400\">Cadet Justification</p>\r\n                          <p className=\"text-sm text-gray-800 dark:text-gray-200 whitespace-pre-wrap\">{appeal.justification}</p>\r\n                      </div>\r\n                      {appeal.issuer_comment && (\r\n                          <div className=\"pl-4 border-l-2 border-blue-300 dark:border-blue-600\">\r\n                              <p className=\"text-xs uppercase font-semibold text-blue-600 dark:text-blue-400\">Issuer Note</p>\r\n                              <p className=\"text-sm text-gray-800 dark:text-gray-200\">{appeal.issuer_comment}</p>\r\n                          </div>\r\n                      )}\r\n                      {appeal.chain_comment && (\r\n                          <div className=\"pl-4 border-l-2 border-purple-300 dark:border-purple-600\">\r\n                              <p className=\"text-xs uppercase font-semibold text-purple-600 dark:text-purple-400\">Chain of Command Note</p>\r\n                              <p className=\"text-sm text-gray-800 dark:text-gray-200\">{appeal.chain_comment}</p>\r\n                          </div>\r\n                      )}\r\n                      {appeal.final_comment && (\r\n                          <div className={`pl-4 border-l-2 ${appeal.status === 'approved' ? 'border-green-500' : 'border-red-500'}`}>\r\n                              <p className={`text-xs uppercase font-semibold ${appeal.status === 'approved' ? 'text-green-600 dark:text-green-400' : 'text-red-600 dark:text-red-400'}`}>\r\n                                  Final Decision\r\n                              </p>\r\n                              <p className=\"text-sm text-gray-800 dark:text-gray-200\">{appeal.final_comment}</p>\r\n                          </div>\r\n                      )}\r\n                  </div>\r\n              </div>\r\n          )}\r\n\r\n          <div className=\"mt-6 grid grid-cols-1 md:grid-cols-3 gap-6 border-t dark:border-gray-700 pt-6\">\r\n            <div><h3 className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">Subject</h3><p className=\"mt-1 text-lg text-gray-900 dark:text-white\">{formatName(report.subject)}</p></div>\r\n            <div><h3 className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">Submitted By</h3><p className=\"mt-1 text-lg text-gray-900 dark:text-white\">{formatName(report.submitter)}</p></div>\r\n            <div><h3 className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">Date & Time</h3><p className=\"mt-1 text-lg text-gray-900 dark:text-white\">{new Date(report.date_of_offense).toLocaleString([], { year: 'numeric', month: 'numeric', day: 'numeric', hour: '2-digit', minute: '2-digit' })}</p></div>\r\n            <div><h3 className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">Category</h3><p className=\"mt-1 text-lg text-gray-900 dark:text-white\">Cat {report.offense_type.offense_code}</p></div>\r\n            <div>\r\n                <h3 className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">Demerits</h3>\r\n                <p className=\"mt-1 text-lg font-bold text-red-600 dark:text-red-400\">\r\n                    {report.demerits_effective !== report.offense_type.demerits ? (\r\n                        <><span className=\"line-through text-gray-400 mr-2\">{report.offense_type.demerits}</span>{report.demerits_effective}</>\r\n                    ) : (report.demerits_effective)}\r\n                </p>\r\n            </div>\r\n          </div>\r\n\r\n          <h3 className=\"text-lg font-medium text-gray-700 dark:text-gray-300 mt-6\">Notes:</h3>\r\n          <p className=\"mt-2 text-sm text-gray-800 dark:text-gray-200 bg-gray-50 dark:bg-gray-700/50 p-4 rounded-md whitespace-pre-wrap\">\r\n            {report.notes || \"No notes provided.\"}\r\n          </p>\r\n\r\n          {/* --- APPEAL ACTION BOX --- */}\r\n          {canActOnAppeal && !isEditing && (\r\n              <div className=\"mt-6 bg-purple-50 dark:bg-purple-900/20 border border-purple-200 dark:border-purple-700 p-6 rounded-lg shadow-sm\">\r\n                  <h3 className=\"text-lg font-medium text-purple-900 dark:text-purple-100 mb-4\">Appeal Action Required</h3>\r\n                  <textarea placeholder=\"Reason for your decision (this will be visible in the appeal record)...\" value={appealComment} onChange={e => setAppealComment(e.target.value)} className=\"w-full rounded-md border-purple-300 dark:border-purple-600 dark:bg-gray-900 dark:text-white mb-4\" rows={3} />\r\n                  <div className=\"flex gap-4\">\r\n                      <button onClick={() => handleAppealAction('grant')} disabled={isActionLoading} className=\"flex-1 py-2 bg-green-600 text-white rounded hover:bg-green-700 disabled:opacity-50\">\r\n                          {appeal?.status === 'pending_commandant' ? 'Final Approval (Grant Appeal)' : 'Grant & Forward to Next Level'}\r\n                      </button>\r\n                      <button onClick={() => handleAppealAction('reject')} disabled={isActionLoading} className=\"flex-1 py-2 bg-red-600 text-white rounded hover:bg-red-700 disabled:opacity-50\">Reject Appeal</button>\r\n                  </div>\r\n              </div>\r\n          )}\r\n\r\n          {/* --- OPTIONS BUTTONS --- */}\r\n          {(canAppeal || canEscalate) && (\r\n              <div className=\"mt-8 border-t dark:border-gray-700 pt-6\">\r\n                  <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">Options</h3>\r\n                  {canAppeal && (\r\n                     <>\r\n                        <p className=\"mt-1 text-sm text-gray-500 dark:text-gray-400 mb-4\">If you believe this report was issued in error, you may submit an appeal.</p>\r\n                        <button onClick={() => setIsAppealing(true)} className=\"py-2 px-4 border border-indigo-600 text-indigo-600 dark:text-indigo-400 dark:border-indigo-400 rounded-md font-medium hover:bg-indigo-50 dark:hover:bg-indigo-900/30 transition-colors\">Appeal this Report</button>\r\n                     </>\r\n                  )}\r\n                  {canEscalate && (\r\n                      <>\r\n                        <p className=\"mt-1 text-sm text-gray-500 dark:text-gray-400 mb-4\">Your appeal was rejected. You may accept this decision or escalate it.</p>\r\n                        <button onClick={() => { setAppealJustification(appeal?.justification || ''); setIsEscalating(true); }} className=\"py-2 px-4 bg-yellow-600 text-white rounded-md font-medium hover:bg-yellow-700 transition-colors\">Escalate Appeal</button>\r\n                      </>\r\n                  )}\r\n              </div>\r\n          )}\r\n\r\n        </div>\r\n      )}\r\n\r\n      {/* --- STANDARD ACTION BOX (Approver / Submitter Revision) --- */}\r\n      {showActionBox && (\r\n        <div className=\"bg-white dark:bg-gray-800 p-6 rounded-lg shadow\">\r\n          <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">Actions</h3>\r\n          <textarea placeholder=\"Add a comment...\" value={comment} onChange={e => setComment(e.target.value)} className=\"mt-4 mb-4 block w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-900 dark:text-white shadow-sm sm:text-sm\" rows={3} />\r\n          <div className=\"flex flex-col sm:flex-row gap-3\">\r\n            <button onClick={() => handleApprovalAction('approve')} disabled={isActionLoading} className=\"flex-1 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:bg-gray-400\">Approve</button>\r\n            <button onClick={() => handleApprovalAction('kickback')} disabled={isActionLoading} className=\"flex-1 py-2 bg-yellow-600 text-white rounded-md hover:bg-yellow-700 disabled:bg-gray-400\">Kick-back</button>\r\n            <button onClick={() => handleApprovalAction('reject')} disabled={isActionLoading} className=\"flex-1 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 disabled:bg-gray-400\">Reject</button>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {showRevisionBox && (\r\n        <div className=\"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-300 dark:border-yellow-700 p-6 rounded-lg\">\r\n          <h3 className=\"text-lg font-medium text-yellow-800 dark:text-yellow-200\">Needs Revision</h3>\r\n          <button onClick={handleEditClick} className=\"mt-4 py-2 px-4 bg-indigo-600 text-white rounded-md hover:bg-indigo-700\">Edit Report</button>\r\n        </div>\r\n      )}\r\n\r\n      {/* --- HISTORY LOG --- */}\r\n      {!isEditing && !isAppealing && !isEscalating && (\r\n          <div className=\"bg-white dark:bg-gray-800 p-6 rounded-lg shadow\">\r\n            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white mb-4\">History</h3>\r\n            <ul className=\"space-y-4\">\r\n              {logs.length > 0 ? logs.map(log => (\r\n                <li key={log.id} className=\"border-b dark:border-gray-700 pb-4 last:border-0\">\r\n                  <div className=\"flex justify-between\">\r\n                    <span className=\"text-sm font-medium text-gray-900 dark:text-white\"><strong>{formatName(log.actor)}</strong>: {log.action}</span>\r\n                    <span className=\"text-xs text-gray-500 dark:text-gray-400\">{new Date(log.created_at).toLocaleString()}</span>\r\n                  </div>\r\n                  {log.comment && <p className=\"mt-2 text-sm bg-gray-50 dark:bg-gray-700/50 p-2 rounded text-gray-600 dark:text-gray-300\">\"{log.comment}\"</p>}\r\n                </li>\r\n              )) : <p className=\"text-gray-500 dark:text-gray-400\">No history yet.</p>}\r\n            </ul>\r\n          </div>\r\n      )}\r\n\r\n    </div>\r\n  )\r\n}"],"names":[],"mappings":"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","debugId":null}}]
}